{"ast":null,"code":"import Cookies from 'js-cookie';\nimport { userLogin } from '@/Servers/ServersApi';\nimport { CryAlgorithm } from '../encryption/index'; //公钥加密函数\n\nimport { mapGetters } from 'vuex'; //获取公钥的相关配置\n\nimport rules from '../encryption/rules';\nexport default {\n  name: \"loginView\",\n\n  data() {\n    return {\n      automaticLogin: false,\n      //自动登录\n      dataForm: {\n        username: '',\n        //账号\n        password: '' //密码\n\n      },\n      checkForm: {\n        username: [{\n          validator: rules.FormValidate.Form().validateUserName,\n          trigger: 'blur'\n        }],\n        password: [{\n          validator: rules.FormValidate.Form().validatePassWord,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n\n  computed: {\n    //判断提交\n    canSubmit() {\n      const {\n        username,\n        password\n      } = this.dataForm;\n      return Boolean(username && password);\n    },\n\n    //获取公钥的ID以及公钥的内容 \n    ...mapGetters('encryption', {\n      getkeyInfo: 'getkeyInfo'\n    })\n  },\n  methods: {\n    //是否自动登录\n    submitLogin() {\n      this.automaticLogin = !this.automaticLogin;\n    },\n\n    //返回首页\n    backHome() {\n      let location = {\n        name: \"Home\"\n      };\n      this.$router.push(location);\n    },\n\n    //登录 \n    goToLogin() {\n      let data = {};\n      data.uuId = this.getkeyInfo.uuId;\n      data.username = this.dataForm.username;\n      data.password = CryAlgorithm(this.getkeyInfo.encryPtion, this.dataForm.password);\n      userLogin(data).then(res => {\n        Cookies.set('name', this.dataForm.username);\n        const name = data.username;\n\n        if (res.data.code === 200) {\n          const token = res.data.data.token;\n          localStorage.setItem('token', token); //保存token到本地浏览器\n\n          this.$message({\n            message: \"恭喜你，登录成功！欢迎用户: \" + name,\n            type: \"success\"\n          });\n          this.$router.push({\n            name: 'Home'\n          });\n        } else if (res.data.code === 400) {\n          this.$message.error(\"用户名或密码错误，请重新输入！\");\n        }\n      });\n    },\n\n    //忘记密码\n    gotoretrieve() {\n      let location = {\n        name: \"Home\"\n      };\n      this.$router.push(location);\n    },\n\n    //获取焦点时显示图片 \n    showImg() {\n      this.showHiddenImg = true;\n    },\n\n    //修改可以查看密码的图片样式 \n    changeImg() {\n      console.log(this.changeHiddenImg);\n      this.changeHiddenImg = !this.changeHiddenImg;\n    }\n\n  },\n\n  mounted() {\n    this.$store.dispatch('encryption/getPubKey');\n  }\n\n};","map":{"version":3,"mappings":"AAiEA;AACA;AACA,mD,CAAA;;AACA,kC,CAAA;;AACA;AAEA;EACAA,iBADA;;EAEAC;IACA;MACAC,qBADA;MACA;MACAC;QACAC,YADA;QACA;QACAC,YAFA,CAEA;;MAFA,CAFA;MAMAC;QACAF,WACA;UAAAG;UAAAC;QAAA,CADA,CADA;QAIAH,WACA;UAAAE;UAAAC;QAAA,CADA;MAJA;IANA;EAeA,CAlBA;;EAmBAC;IACA;IACAC;MACA;QAAAN;QAAAC;MAAA;MACA;IACA,CALA;;IAMA;IACA;MACAM;IADA;EAPA,CAnBA;EA8BAC;IACA;IACAC;MACA;IACA,CAJA;;IAKA;IACAC;MACA;QAAAd;MAAA;MACA;IACA,CATA;;IAUA;IACAe;MACA;MACAd;MACAA;MACAA;MACAe;QACAC;QACA;;QACA;UACA;UACAC,qCAFA,CAEA;;UACA;YACAC,iCADA;YAEAC;UAFA;UAIA;YAAApB;UAAA;QACA,CARA,MAQA;UACA;QACA;MACA,CAdA;IAgBA,CAhCA;;IAiCA;IACAqB;MACA;QAAArB;MAAA;MACA;IACA,CArCA;;IAsCA;IACAsB;MACA;IACA,CAzCA;;IA0CA;IACAC;MACAC;MACA;IACA;;EA9CA,CA9BA;;EA8EAC;IACA;EACA;;AAhFA","names":["name","data","automaticLogin","dataForm","username","password","checkForm","validator","trigger","computed","canSubmit","getkeyInfo","methods","submitLogin","backHome","goToLogin","userLogin","Cookies","localStorage","message","type","gotoretrieve","showImg","changeImg","console","mounted"],"sourceRoot":"src/views","sources":["loginView.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <vue-particles color=\"#e8f659\" :particleOpacity=\"0.7\" :particlesNumber=\"60\" shapeType=\"circle\" :particleSize=\"6\"\r\n      linesColor=\"#e8f659\" :linesWidth=\"1\" :lineLinked=\"true\" :lineOpacity=\"0.4\" :linesDistance=\"150\" :moveSpeed=\"3\"\r\n      :hoverEffect=\"true\" hoverMode=\"grab\" :clickEffect=\"true\" clickMode=\"push\">\r\n    </vue-particles>\r\n    <div class=\"login_container\">\r\n      <div class=\"login_box\">\r\n\r\n        <div class=\"avatar_box\">\r\n          <img src=\"../assets/Img/LoginImg/tx.jpg\" alt=\"\" />\r\n        </div>\r\n\r\n        <el-form label-width=\"0px\" class=\"login_in\"  ref=\"dataForm\" :model=\"dataForm\" :rules=\"checkForm\">\r\n\r\n          <div class=\"form-info\">\r\n            <el-form-item prop=\"username\">\r\n              <el-input \r\n                type=\"text\" \r\n                prefix-icon=\"el-icon-user\" \r\n                placeholder=\"请输入账号\" \r\n                v-model=\"dataForm.username\">\r\n              </el-input>\r\n            </el-form-item>\r\n            <el-form-item prop=\"password\">\r\n              <el-input type=\"password\" prefix-icon=\"el-icon-thumb\" placeholder=\"请输入密码\" v-model=\"dataForm.password\">\r\n              </el-input>\r\n            </el-form-item>\r\n          </div>\r\n          <div class=\"tablenav\">\r\n            <div class=\"navleft\">\r\n              <div class=\"leftbtn\">\r\n                <div :class=\"automaticLogin === false ? 'dashDiv' : 'dashDivSelectd'\">\r\n                  <span class=\"dashSpan\" @click=\"submitLogin\"></span>\r\n                </div>\r\n                <div class=\"prompt\">自动登录</div>\r\n              </div>\r\n            </div>\r\n            <div class=\"navright\">\r\n              <div class=\"prompt\" @click=\"gotoretrieve\">忘记密码</div>\r\n            </div>\r\n          </div>\r\n\r\n          <el-form-item class=\"btns\">\r\n            <el-button type=\"primary\" @click=\"goToLogin\" :disabled=\"!canSubmit\">登&nbsp;&nbsp;&nbsp;&nbsp;录</el-button>\r\n          </el-form-item>\r\n\r\n          <div class=\"stytem\">\r\n            <div class=\"stytem-left\">\r\n              <div class=\"lefttitle\" @click=\"backHome()\">返回首页</div>\r\n            </div>\r\n            <div class=\"stytem-right\">\r\n              <div class=\"righttitle\">\r\n                <router-link :to=\"{ name: 'registerView' }\">用户注册</router-link>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n        </el-form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Cookies from 'js-cookie';\r\nimport { userLogin } from '@/Servers/ServersApi';  \r\nimport {CryAlgorithm} from '../encryption/index'  //公钥加密函数\r\nimport {mapGetters} from 'vuex'  //获取公钥的相关配置\r\nimport rules from '../encryption/rules'\r\n\r\nexport default {\r\n  name: \"loginView\",\r\n  data() {\r\n    return {\r\n      automaticLogin: false, //自动登录\r\n      dataForm: {\r\n        username: '', //账号\r\n        password: '', //密码\r\n      },\r\n      checkForm:{\r\n        username:[\r\n          {validator: rules.FormValidate.Form().validateUserName,trigger:'blur'}\r\n        ],\r\n        password:[\r\n          {validator: rules.FormValidate.Form().validatePassWord,trigger:'blur'}\r\n        ],\r\n      },\r\n    };\r\n  },\r\n  computed: {\r\n    //判断提交\r\n    canSubmit() {\r\n      const { username, password } = this.dataForm\r\n      return Boolean(username && password)\r\n    },\r\n    //获取公钥的ID以及公钥的内容 \r\n    ...mapGetters('encryption',{\r\n      getkeyInfo:'getkeyInfo'\r\n    })\r\n  },\r\n  methods: {\r\n    //是否自动登录\r\n    submitLogin() {\r\n      this.automaticLogin = !this.automaticLogin;\r\n    },\r\n    //返回首页\r\n    backHome() {\r\n      let location = { name: \"Home\" };\r\n      this.$router.push(location);\r\n    },\r\n    //登录 \r\n    goToLogin() {\r\n      let data = {}\r\n      data.uuId = this.getkeyInfo.uuId\r\n      data.username = this.dataForm.username\r\n      data.password = CryAlgorithm(this.getkeyInfo.encryPtion,this.dataForm.password)\r\n      userLogin(data).then(res => {\r\n        Cookies.set('name', this.dataForm.username)\r\n        const name = data.username\r\n        if (res.data.code === 200) {\r\n        const token = res.data.data.token\r\n        localStorage.setItem('token', token)  //保存token到本地浏览器\r\n          this.$message({\r\n            message: \"恭喜你，登录成功！欢迎用户: \" + name,\r\n            type: \"success\",\r\n          })\r\n          this.$router.push({ name: 'Home' })\r\n        }else if (res.data.code === 400) {\r\n          this.$message.error(\"用户名或密码错误，请重新输入！\")\r\n        }\r\n      })\r\n\r\n    },\r\n    //忘记密码\r\n    gotoretrieve(){\r\n      let location = { name: \"Home\" };\r\n      this.$router.push(location);\r\n    },\r\n    //获取焦点时显示图片 \r\n    showImg(){\r\n      this.showHiddenImg = true\r\n    },\r\n    //修改可以查看密码的图片样式 \r\n    changeImg(){\r\n      console.log(this.changeHiddenImg);\r\n      this.changeHiddenImg = !this.changeHiddenImg\r\n    }\r\n  },\r\n  mounted(){\r\n    this.$store.dispatch('encryption/getPubKey');\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n#particles-js {\r\n  width: 100%;\r\n  height: calc(100%);\r\n  position: absolute;\r\n  background-image: url(\"../assets/Img/LoginImg/background.png\");\r\n  background-repeat: no-repeat;\r\n  background-size: cover;\r\n}\r\n\r\n.login_container {\r\n  z-index: 55;\r\n  background-color: #42b983;\r\n  height: 100%;\r\n}\r\n\r\n.el-form-item {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.login_box {\r\n  width: 450px;\r\n  height: 300px;\r\n  border-radius: 3px;\r\n  position: absolute;\r\n  left: 50%;\r\n  top: 50%;\r\n  transform: translate(-50%, -50%);\r\n\r\n  .avatar_box {\r\n    height: 130px;\r\n    width: 130px;\r\n    border: 1px solid #eee;\r\n    border-radius: 50%;\r\n    box-shadow: 0 0 10px #ddd;\r\n    position: absolute;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    background-color: #fff;\r\n    padding: 10px;\r\n\r\n    img {\r\n      width: 100%;\r\n      height: 100%;\r\n      border-radius: 50%;\r\n      background-color: #eee;\r\n    }\r\n  }\r\n}\r\n\r\n.btns {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.login_in {\r\n    z-index: 999;\r\n    position: absolute;\r\n    bottom: -15px;\r\n    width: 100%;\r\n    padding: 0 20px;\r\n    box-sizing: border-box;\r\n\r\n\r\n  //选择方式\r\n  .navSelect {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    color: #ffffff;\r\n    font-size: 18px;\r\n    font-family: \"楷体\";\r\n\r\n    .select-left {\r\n      position: relative;\r\n      margin-left: 50px;\r\n      cursor: pointer;\r\n\r\n      .btn-selected {\r\n        position: absolute;\r\n        width: 60px;\r\n        height: 2px;\r\n        bottom: -1px;\r\n        left: 9px;\r\n        background-color: #ffffff;\r\n      }\r\n    }\r\n\r\n    .select-right {\r\n      position: relative;\r\n      margin-right: 50px;\r\n      cursor: pointer;\r\n\r\n      .btn-selected {\r\n        position: absolute;\r\n        width: 60px;\r\n        height: 2px;\r\n        bottom: -1px;\r\n        right: 9px;\r\n        background-color: #ffffff;\r\n      }\r\n    }\r\n  }\r\n\r\n  .verification {\r\n\r\n    //验证码登录的输入框\r\n    .el-input {\r\n      width: 240px;\r\n    }\r\n\r\n    .getVerificationCode {\r\n      position: absolute;\r\n      width: 100px;\r\n      height: 40px;\r\n      top: 0px;\r\n      right: 20px;\r\n      border-radius: 4px;\r\n      text-align: center;\r\n      cursor: pointer;\r\n      color: #ffffff;\r\n      background-color: #409eff;\r\n    }\r\n  }\r\n\r\n  .tablenav {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    font-family: \"楷体\";\r\n\r\n    .navleft {\r\n      margin-left: 30px;\r\n\r\n      .leftbtn {\r\n        display: flex;\r\n\r\n        //未选中状态\r\n        .dashDiv {\r\n          border-radius: 1.8667rem;\r\n          border: 0.03rem solid #cbcbcb;\r\n          background-color: #dad6d6;\r\n          width: 42px;\r\n          height: 16px;\r\n          margin-top: 0.26rem;\r\n          margin-right: 0.4rem;\r\n          box-sizing: border-box;\r\n        }\r\n\r\n        .dashDiv .dashSpan {\r\n          border-radius: 7px;\r\n          border: 0.03rem solid #cbcbcb;\r\n          background-color: #ffffff;\r\n          float: left;\r\n          margin-left: 0.04rem;\r\n          margin-top: 0.019rem;\r\n          width: 24px;\r\n          height: 14px;\r\n          box-sizing: border-box;\r\n        }\r\n\r\n        /*选中状态*/\r\n        .dashDivSelectd {\r\n          background-color: #4cd964;\r\n          transition: 0.5s;\r\n          border-radius: 1.8667rem;\r\n          border: 0.03rem solid #ffffff;\r\n          width: 42px;\r\n          height: 16px;\r\n          margin-top: 0.26rem;\r\n          margin-right: 0.4rem;\r\n          box-sizing: border-box;\r\n        }\r\n\r\n        .dashDivSelectd .dashSpan {\r\n          border-radius: 7px;\r\n          border: 0.03rem solid #ffffff;\r\n          background-color: #ffffff;\r\n          float: right;\r\n          margin-right: 0.04rem;\r\n          margin-top: 0.019rem;\r\n          width: 24px;\r\n          height: 14px;\r\n          box-sizing: border-box;\r\n        }\r\n      }\r\n    }\r\n\r\n    .navright {\r\n      margin-right: 30px;\r\n    }\r\n\r\n    .prompt {\r\n      margin-top: 1px;\r\n      color: #ffffff;\r\n      font-size: 18px;\r\n      font-family: 楷体;\r\n    }\r\n  }\r\n\r\n  //选择链接 \r\n  .stytem {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-content: center;\r\n\r\n    .stytem-left {\r\n      .lefttitle {\r\n        margin-left: 35px;\r\n        font-size: 14px;\r\n        color: #ffffff;\r\n      }\r\n    }\r\n\r\n    .stytem-right {\r\n      .righttitle {\r\n        margin-right: 35px;\r\n        font-size: 14px;\r\n        color: #ffffff;\r\n      }\r\n    }\r\n\r\n    .righttitle:hover {\r\n      color: rgb(236, 60, 11);\r\n      cursor: pointer;\r\n    }\r\n\r\n    .lefttitle:hover {\r\n      color: rgb(236, 60, 11);\r\n      cursor: pointer;\r\n    }\r\n  }\r\n\r\n  .prompt:hover {\r\n    color: rgb(236, 60, 11);\r\n    cursor: pointer;\r\n  }\r\n\r\n  //修改了button的形式 \r\n  .el-button {\r\n    padding: 12px 110px;\r\n  }\r\n\r\n  //修改输入框大小 \r\n  .el-input {\r\n    left: 7%;\r\n    width: 360px;\r\n  }\r\n}\r\n/deep/.el-form-item__error{\r\n      color: #F56C6C;\r\n      font-size: 14px;\r\n      padding: 3px 0px;\r\n      position: absolute;\r\n      top: 100%;\r\n      left: 35px;\r\n}\r\n.clickImg{\r\n    display: flex;\r\n    position: absolute;\r\n    right: 60px;\r\n    top: 50%;\r\n    transform: translate(-50%, -50%);\r\n    .hiddenImg{\r\n      width: 24px;\r\n      height: 24px;\r\n      background: url(../assets/Img/Icon/hidden1.png) no-repeat center center;\r\n    }\r\n    .showImg{\r\n      width: 24px;\r\n      height: 24px;\r\n      background: url(../assets/Img/Icon/show1.png) no-repeat center center;\r\n    }\r\n  }\r\n</style>"]},"metadata":{},"sourceType":"module"}