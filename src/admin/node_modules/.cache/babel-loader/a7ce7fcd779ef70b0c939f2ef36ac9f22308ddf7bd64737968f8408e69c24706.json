{"ast":null,"code":"import exportExcle from '../../utils/exportExcle';\nimport giveUserRole from \"../../components/userPopup/giveUserRole\";\nimport addUserPopup from \"../../components/userPopup/addUserPopup\";\nimport { getuserListApi, userDelete } from \"../../services/systemManage\";\nexport default {\n  name: \"MemberArchive\",\n  data() {\n    return {\n      searchForm: {\n        // 查询条件\n        key: \"\"\n      },\n      //根据后端所川回的值\n      tableData: [],\n      total: 0,\n      //页面总条数\n      page: 1,\n      //请求第一次的params\n      pageSize: 6\n    };\n  },\n  components: {\n    giveUserRole,\n    addUserPopup\n  },\n  mounted() {\n    this.getFollowdiaryList();\n  },\n  methods: {\n    //导出函数用户数据\n    exportExcel() {\n      var csv = exportExcle.tableTocsv(this.$refs.excleTable);\n      var sheet = exportExcle.csvTosheet(csv);\n      var blob = exportExcle.sheetToblob(sheet);\n      exportExcle.openDownloadDialog(blob, '导出.xlsx');\n    },\n    //获取所有列表的信息\n    getFollowdiaryList() {\n      getuserListApi(this.page).then(res => {\n        if (res.data.code === 200) {\n          this.tableData = res.data.data.list; //后端返回的值赋值给页面\n          this.total = res.data.data.total; //后端返回的总数量 \n        } else if (res.data.code === 417) {\n          this.tableData = [];\n          this.total = 0;\n        }\n      });\n    },\n    //分页\n    handleCurrentChange(page) {\n      this.page = page;\n      this.getFollowdiaryList();\n    },\n    //赋予角色\n    giveUserRole(fatherItem) {\n      this.$refs.giveUserRole.showGiveRoles(fatherItem);\n    },\n    //删除列表\n    deleteROW(fatherItem) {\n      this.$confirm(\"此操作将永久删除该用户, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        userDelete(fatherItem.userId).then(() => {\n          this.$message({\n            message: \"删除用户成功！\",\n            type: \"success\"\n          });\n          this.getFollowdiaryList(); //更新列表\n        }).catch(() => {\n          console.log(\"错误捕获\");\n        });\n      }).catch(() => {\n        this.$message({\n          type: \"info\",\n          message: \"已取消删除\"\n        });\n      });\n    },\n    //新增用户弹窗\n    addUserBtn() {\n      this.$refs.addUserPopup.showDialog();\n    }\n  }\n};","map":{"version":3,"mappings":"AA8DA;AACA;AACA;AACA;AACA;EACAA;EACAC;IACA;MACAC;QACA;QACAC;MACA;MACA;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;IACA;EACA;EACAC;IAAAC;IAAAC;EAAA;EAGAC;IACA;EACA;EACAC;IAEA;IACAC;MACA;MACA;MACA;MACAC;IACA;IACA;IACAC;MACAC;QACA;UACA;UACA;QACA;UACA;UACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;IACA;IACA;IACAR;MACA;IACA;IACA;IACAS;MACA;QACAC;QACAC;QACAC;MACA,GACAC;QACAC,8BACAD;UACA;YACAE;YACAH;UACA;UACA;QACA,GACAI;UACAC;QACA;MACA,GACAD;QACA;UACAJ;UACAG;QACA;MACA;IACA;IACA;IACAG;MACA;IACA;EACA;AACA","names":["name","data","searchForm","key","tableData","total","page","pageSize","components","giveUserRole","addUserPopup","mounted","methods","exportExcel","exportExcle","getFollowdiaryList","getuserListApi","handleCurrentChange","deleteROW","confirmButtonText","cancelButtonText","type","then","userDelete","message","catch","console","addUserBtn"],"sourceRoot":"src/views/systemManage","sources":["userManage.vue"],"sourcesContent":["<!--用户管理-->\r\n<template>\r\n  <div class=\"appMain\">\r\n    <div class=\"filter-container\">\r\n      <div class=\"filter-container-searchInput\">\r\n        <el-input placeholder=\"头部尚未任何操作\"></el-input>\r\n      </div>\r\n      <div class=\"filter-container-searchBtn\">\r\n        <el-button type=\"primary\" icon=\"el-icon-search\">搜索</el-button>\r\n      </div>\r\n      <div class=\"filter-container-addBtn\">\r\n        <el-button type=\"primary\" icon=\"el-icon-plus\" @click=\"addUserBtn\" v-has=\"`system:user:add`\">新 增</el-button>\r\n      </div>\r\n      <div class=\"filter-container-exportExcle\">\r\n        <el-button type=\"primary\" icon=\"el-icon-plus\" @click=\"exportExcel\">导出为excle</el-button>\r\n      </div>\r\n    </div>\r\n    <!--主题-->\r\n    <!-- contenteditable=\"true\"-->\r\n    <table style=\"width: 100%\" class=\"filter-table\" id=\"result\" ref=\"excleTable\">\r\n      <tr class=\"tableTypeNav\">\r\n        <th class=\"userId\">ID</th>\r\n        <th class=\"username\">用户名</th>\r\n        <th class=\"nickname\">昵称</th>\r\n        <th class=\"email\">邮箱</th>\r\n        <th class=\"sex\">性别</th>\r\n        <th class=\"age\">年龄</th>\r\n        <th class=\"roles\">角色</th>\r\n        <th class=\"action\">操作</th>\r\n      </tr>\r\n      <tr class=\"tableDataItem\" v-for=\"(fatherItem) in tableData\" :key=\"fatherItem.userId\">\r\n        <td class=\"userId\">{{ fatherItem.userId }}</td>\r\n        <td class=\"username\">{{ fatherItem.username }}</td>\r\n        <td class=\"nickname\">{{ fatherItem.nickname }}</td>\r\n        <td class=\"email\">{{ fatherItem.email }}</td>\r\n        <td class=\"sex\">{{ fatherItem.sex }}</td>\r\n        <td class=\"age\">{{ fatherItem.age }}</td>\r\n        <div class=\"roles\">\r\n          <el-tag type=\"success\" v-for=\"childItem in fatherItem.roles\" :key=\"childItem.roleId\">{{\r\n            childItem.name\r\n          }}</el-tag>\r\n        </div>\r\n        <div class=\"action\">\r\n          <el-button type=\"success\" size=\"mini\" @click=\"giveUserRole(fatherItem)\"\r\n            v-has=\"`system:user:update`\">赋角色</el-button>\r\n          <el-button type=\"primary\" size=\"mini\">查看</el-button>\r\n          <el-button type=\"danger\" size=\"mini\" @click=\"deleteROW(fatherItem)\"\r\n            v-has=\"`system:user:delete`\">删除</el-button>\r\n        </div>\r\n      </tr>\r\n    </table>\r\n    <!--分页表单-->\r\n    <el-pagination background layout=\"prev, pager, next\" :total=\"total\" :page-size=\"pageSize\" class=\"filter-page\"\r\n      @current-change=\"handleCurrentChange\">\r\n    </el-pagination>\r\n\r\n    <giveUserRole ref=\"giveUserRole\"></giveUserRole>\r\n    <addUserPopup ref=\"addUserPopup\"></addUserPopup>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport exportExcle from '../../utils/exportExcle'\r\nimport giveUserRole from \"../../components/userPopup/giveUserRole\";\r\nimport addUserPopup from \"../../components/userPopup/addUserPopup\";\r\nimport { getuserListApi, userDelete } from \"../../services/systemManage\";\r\nexport default {\r\n  name: \"MemberArchive\",\r\n  data() {\r\n    return {\r\n      searchForm: {\r\n        // 查询条件\r\n        key: \"\",\r\n      },\r\n      //根据后端所川回的值\r\n      tableData: [],\r\n      total: 0, //页面总条数\r\n      page: 1, //请求第一次的params\r\n      pageSize: 6,\r\n    };\r\n  },\r\n  components: { giveUserRole, addUserPopup },\r\n\r\n\r\n  mounted() {\r\n    this.getFollowdiaryList();\r\n  },\r\n  methods: {\r\n\r\n    //导出函数用户数据\r\n    exportExcel() {\r\n      var csv = exportExcle.tableTocsv(this.$refs.excleTable)\r\n      var sheet = exportExcle.csvTosheet(csv)\r\n      var blob = exportExcle.sheetToblob(sheet);\r\n      exportExcle.openDownloadDialog(blob, '导出.xlsx')\r\n    },\r\n    //获取所有列表的信息\r\n    getFollowdiaryList() {\r\n      getuserListApi(this.page).then((res) => {\r\n        if (res.data.code === 200) {\r\n          this.tableData = res.data.data.list; //后端返回的值赋值给页面\r\n          this.total = res.data.data.total; //后端返回的总数量 \r\n        } else if (res.data.code === 417) {\r\n          this.tableData = []\r\n          this.total = 0\r\n        }\r\n      });\r\n    },\r\n    //分页\r\n    handleCurrentChange(page) {\r\n      this.page = page;\r\n      this.getFollowdiaryList();\r\n    },\r\n    //赋予角色\r\n    giveUserRole(fatherItem) {\r\n      this.$refs.giveUserRole.showGiveRoles(fatherItem);\r\n    },\r\n    //删除列表\r\n    deleteROW(fatherItem) {\r\n      this.$confirm(\"此操作将永久删除该用户, 是否继续?\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\",\r\n      })\r\n        .then(() => {\r\n          userDelete(fatherItem.userId)\r\n            .then(() => {\r\n              this.$message({\r\n                message: \"删除用户成功！\",\r\n                type: \"success\",\r\n              })\r\n              this.getFollowdiaryList(); //更新列表\r\n            })\r\n            .catch(() => {\r\n              console.log(\"错误捕获\");\r\n            })\r\n        })\r\n        .catch(() => {\r\n          this.$message({\r\n            type: \"info\",\r\n            message: \"已取消删除\",\r\n          });\r\n        });\r\n    },\r\n    //新增用户弹窗\r\n    addUserBtn() {\r\n      this.$refs.addUserPopup.showDialog();\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped lang=\"less\">\r\n.filter-container {\r\n  padding: 10px;\r\n  display: flex;\r\n\r\n  .filter-container-searchInput,\r\n  .filter-container-searchBtn,\r\n  .filter-container-addBtn,\r\n  .filter-container-exportExcle {\r\n    margin-right: 10px;\r\n  }\r\n}\r\n\r\n.filter-table {\r\n  min-width: 1420px;\r\n\r\n  .tableTypeNav,\r\n  .tableDataItem {\r\n    display: flex;\r\n    align-items: center;\r\n    text-align: center;\r\n\r\n    .userId,\r\n    .username,\r\n    .nickname {\r\n      width: 160px;\r\n    }\r\n\r\n    .email {\r\n      width: 220px;\r\n    }\r\n\r\n    .sex,\r\n    .age {\r\n      width: 100px;\r\n\r\n    }\r\n\r\n    .roles {\r\n      font-weight: 400;\r\n      width: 280px;\r\n      color: #606266;\r\n      .el-tag {\r\n        margin: 0 5px;\r\n      }\r\n    }\r\n\r\n    .userId,\r\n    .sex,\r\n    .age,\r\n    .email,\r\n    .nickname,\r\n    .username{\r\n      height: 100%;\r\n      font-weight: 400;\r\n      display: inline-block;\r\n      box-sizing: border-box;\r\n      color: #606266;\r\n      overflow: hidden;\r\n      padding-left: 10px;\r\n      padding-right: 10px;\r\n    }\r\n\r\n    .action {\r\n      font-weight: 400;\r\n      padding: 12px 0;\r\n      width: 200px;\r\n      height: 100%;\r\n      color: #606266;\r\n    }\r\n  }\r\n\r\n  .tableDataItem {\r\n    height: 50px;\r\n    line-height: 50px;\r\n  }\r\n\r\n}\r\n\r\n</style>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}