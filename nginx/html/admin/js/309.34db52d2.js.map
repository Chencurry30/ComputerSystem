{"version":3,"file":"js/309.34db52d2.js","mappings":"sJAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,UAAU,CAACF,EAAG,UAAU,CAACE,YAAY,YAAY,CAACF,EAAG,MAAM,CAACE,YAAY,qBAAqBC,MAAM,CAAC,KAAO,UAAUC,KAAK,UAAU,CAACJ,EAAG,YAAY,CAACK,WAAW,CAAC,CAACC,KAAK,MAAMC,QAAQ,QAAQC,MAAQ,kBAAkBC,WAAW,sBAAsBN,MAAM,CAAC,KAAO,UAAU,KAAO,kBAAkBO,GAAG,CAAC,MAAQZ,EAAIa,UAAU,CAACb,EAAIc,GAAG,UAAUZ,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,UAAU,KAAO,kBAAkBO,GAAG,CAAC,MAAQZ,EAAIe,cAAc,CAACf,EAAIc,GAAG,WAAW,GAAGd,EAAIgB,GAAIhB,EAAIiB,WAAW,SAASC,GAAM,OAAOhB,EAAG,MAAM,CAACiB,IAAID,EAAKE,OAAOhB,YAAY,aAAa,CAACF,EAAG,MAAM,CAACE,YAAY,YAAY,CAACJ,EAAIc,GAAG,IAAId,EAAIqB,GAAGH,EAAKV,MAAM,OAAON,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,YAAY,CAACK,WAAW,CAAC,CAACC,KAAK,MAAMC,QAAQ,QAAQC,MAAQ,sBAAsBC,WAAW,0BAA0BN,MAAM,CAAC,KAAO,UAAU,KAAO,OAAO,KAAO,eAAe,OAAS,IAAIO,GAAG,CAAC,MAAQ,SAASU,GAAQ,OAAOtB,EAAIuB,SAASL,EAAK,KAAMA,EAAKE,OAAS,EAAGlB,EAAG,YAAY,CAACK,WAAW,CAAC,CAACC,KAAK,MAAMC,QAAQ,QAAQC,MAAQ,qBAAqBC,WAAW,yBAAyBN,MAAM,CAAC,KAAO,UAAU,KAAO,OAAO,KAAO,iBAAiB,OAAS,IAAIO,GAAG,CAAC,MAAQ,SAASU,GAAQ,OAAOtB,EAAIwB,WAAWN,EAAKE,OAAO,KAAKpB,EAAIyB,MAAM,IAAI,KAAI,GAAGvB,EAAG,eAAe,CAACwB,IAAI,eAAed,GAAG,CAAC,WAAaZ,EAAI2B,cAAczB,EAAG,kBAAkB,CAACwB,IAAI,qBAAqB,EACn5C,EACIE,EAAkB,G,UCFlB7B,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,UAAU,CAACF,EAAG,YAAY,CAACG,MAAM,CAAC,MAAQ,OAAO,QAAUL,EAAI6B,cAAc,MAAQ,MAAM,OAAS,IAAIjB,GAAG,CAAC,iBAAiB,SAASU,GAAQtB,EAAI6B,cAAcP,CAAM,IAAI,CAACpB,EAAG,UAAU,CAACwB,IAAI,WAAWtB,YAAY,WAAWC,MAAM,CAAC,cAAc,MAAM,MAAQL,EAAI8B,WAAW,CAAC5B,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,SAAS,CAACH,EAAG,WAAW,CAACG,MAAM,CAAC,KAAO,OAAO,cAAc,eAAe,YAAc,cAAc0B,MAAM,CAACrB,MAAOV,EAAI8B,SAAStB,KAAMwB,SAAS,SAAUC,GAAMjC,EAAIkC,KAAKlC,EAAI8B,SAAU,OAAwB,kBAARG,EAAkBA,EAAIE,OAAQF,EAAK,EAAEtB,WAAW,oBAAoB,GAAGT,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,YAAY,CAACH,EAAG,WAAW,CAACG,MAAM,CAAC,cAAc,eAAe,YAAc,cAAc0B,MAAM,CAACrB,MAAOV,EAAI8B,SAASM,QAASJ,SAAS,SAAUC,GAAMjC,EAAIkC,KAAKlC,EAAI8B,SAAU,UAA2B,kBAARG,EAAkBA,EAAIE,OAAQF,EAAK,EAAEtB,WAAW,uBAAuB,IAAI,KAAKT,EAAG,OAAO,CAACE,YAAY,gBAAgBC,MAAM,CAAC,KAAO,UAAUC,KAAK,UAAU,CAACJ,EAAG,YAAY,CAACU,GAAG,CAAC,MAAQZ,EAAIqC,qBAAqB,CAACrC,EAAIc,GAAG,SAASZ,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAWO,GAAG,CAAC,MAAQ,SAASU,GAAQtB,EAAIsC,oBAAoBtC,EAAIuC,YAAY,IAAI,CAACvC,EAAIc,GAAG,UAAU,IAAI,IAAI,EACpxC,EACIc,EAAkB,GCmCtB,GACApB,KAAAA,eACAgC,OACA,OACAV,SAAAA,CACAtB,KAAAA,GACA4B,QAAAA,GACAhB,OAAAA,GAEAS,eAAAA,EAEA,EACAY,QAAAA,CACAJ,qBACA,qBACA,EACAC,oBACA,sCACA,EACAC,aACA,sCACA,IC1DqQ,I,UCOjQG,GAAY,OACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIF,EAAeA,EAAiB,QClB5B3C,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACK,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,MAAOV,EAAI2C,WAAYhC,WAAW,eAAeP,YAAY,WAAW,CAACF,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,SAAS,CAACE,YAAY,aAAa,CAACJ,EAAIc,GAAG,YAAYZ,EAAG,SAAS,CAACE,YAAY,YAAYC,MAAM,CAAC,KAAO,WAAW,CAACL,EAAIc,GAAGd,EAAIqB,GAAGrB,EAAI4C,cAAc,GAAG1C,EAAG,UAAU,CAACwB,IAAI,OAAOtB,YAAY,WAAWC,MAAM,CAAC,KAAOL,EAAI6C,KAAK,gBAAgB,GAAG,WAAW,SAAS,uBAAuB7C,EAAI8C,aAAa,EACthB,EACIlB,EAAkB,G,QCDf,MAAMmB,EAAmB,CAACC,EAASC,KACtC,IAAIC,EAAO,GACPhC,EAAO,CAAC,EACRiC,EAASF,EAOb,OANAC,EAAOF,EACPE,EAAKE,SAAQC,IACTnC,EAAKoC,OAASD,EAAQC,OACtBH,EAAOI,KAAKrC,GACZA,EAAK,CAAC,CAAC,IAEJiC,CAAM,ECMjB,OACA3C,KAAAA,kBACAgC,OACA,OACAK,KAAAA,GACAC,SAAAA,GACAH,YAAAA,EACAa,YAAAA,GACAZ,SAAAA,GAEA,EACAa,UACA,cACA,EACAhB,QAAAA,CAEAiB,aAAAA,EAAAA,EAAAA,GACA,mCACA,gBACA,kBACAC,EAAAA,EAAAA,IAAAA,GAAAA,MAAAA,IAEA,GADAC,QAAAA,IAAAA,GACA,mBACA,kBACApB,EAAAA,SAAAA,IACA,aACAqB,EAAAA,KAAAA,EAAAA,OACA,IAEAD,QAAAA,IAAAA,QAAAA,KAAAA,UACA,gBACA,kBACA,0BACA,iBACAA,QAAAA,WAAAA,KAAAA,UACA,mBACA,GAEA,EAEAE,WACAA,EAAAA,EAAAA,MAAAA,MAAAA,IACA,oBACA,sBACA,GAEA,EAEAC,kBACA,4DACA,kBACA,EAEAC,sBACA,gEACA,kBACA,EAEAC,gBAAAA,GACA,wBACA,uCACA,CACA,uBACA,2BACA,SACAzB,EAAAA,OAAAA,EACAA,EAAAA,SAAAA,KAAAA,aACA0B,EAAAA,EAAAA,IAAAA,GAAAA,MAAAA,IACA,mBACA,mCACA,oBAEA,uCAEA,sBAEA,CACA,IC9FwQ,ICQpQ,GAAY,OACd,EACA,EACA,GACA,EACA,KACA,WACA,MAIF,EAAe,EAAiB,QCUhC,GACA1B,OACA,OAEAvB,UAAAA,GACAG,OAAAA,EACA+C,UAAAA,EAEA,EACAC,WAAAA,CACAC,aAAAA,EACAC,gBAAAA,GAEAb,UAEA,eACA,EACAhB,QAAAA,CAEA8B,YACAC,EAAAA,EAAAA,MAAAA,MAAAA,IACAZ,QAAAA,IAAAA,GACA,kBACA,2BACA,mBACA,8BACA,GAEA,EAEA/C,UACA,2CACA,EAEAU,SAAAA,GACA,iBACA,qBACA,2DACA,EAEAC,WAAAA,IACAiD,EAAAA,EAAAA,IAAAA,GAAAA,MAAAA,IACA,mBACA,iCACA,iBAEA,oCACA,GAEA,EAEA1D,cACA,uDACA,EAEAY,WAAAA,IACAd,EAAAA,EAAAA,IAAAA,GAAAA,MAAAA,IACA,mBAEA,eACA,GAEA,IC3FsQ,ICQlQ,GAAY,OACd,EACAd,EACA6B,GACA,EACA,KACA,WACA,MAIF,EAAe,EAAiB,O,8XCjBzB,MAAM4C,EAAc,KACzB,MAAME,EAAM,eACZ,OAAOC,EAAAA,EAAAA,IAAYD,EAAI,EAGZ7D,EAAW2B,IACtB,MAAMkC,EAAM,eACZ,OAAOC,EAAAA,EAAAA,KAAaD,EAAIlC,EAAK,EAIlBmB,EAAYiB,IACvB,MAAMF,EAAO,qBAAoBE,IACjC,OAAOD,EAAAA,EAAAA,IAAYD,EAAI,EAIZZ,EAAU,KACrB,MAAMY,EAAO,oBACb,OAAOC,EAAAA,EAAAA,IAAYD,EAAI,EAIZR,EAAY1B,IACvB,MAAMkC,EAAM,oBACZ,OAAOC,EAAAA,EAAAA,IAAYD,EAAIlC,EAAM,EAIlBiC,EAAcrD,IACzB,MAAMsD,EAAO,gBAAetD,IAC5B,OAAOuD,EAAAA,EAAAA,UAAeD,EAAI,EAGfG,EAAkBC,IAC7B,MAAMJ,EAAO,sBAAqBI,IAClC,OAAOH,EAAAA,EAAAA,IAAYD,EAAI,EAGZK,EAAavC,IACxB,MAAMkC,EAAM,oBACZ,OAAOC,EAAAA,EAAAA,IAAYD,EAAIlC,EAAK,EAGjBwC,EAAcC,IACzB,MAAMP,EAAO,gBAAeO,IAC5B,OAAON,EAAAA,EAAAA,UAAeD,EAAI,EAGfQ,EAAW1C,IACtB,MAAMkC,EAAO,eACb,OAAOC,EAAAA,EAAAA,KAAaD,EAAIlC,EAAK,EAGlB2C,EAAcL,IACzB,MAAMJ,EAAO,qBAAoBI,IACjC,OAAOH,EAAAA,EAAAA,IAAYD,EAAI,EAKZU,EAAaH,IACxB,MAAMP,EAAO,eAAcO,IAC3B,OAAON,EAAAA,EAAAA,UAAeD,EAAI,EAIfW,EAAc7C,IACzB,MAAMkC,EAAO,cACb,OAAOC,EAAAA,EAAAA,KAAaD,EAAIlC,EAAK,EAIlB8C,EAAYL,IACvB,MAAMP,EAAO,qBAAoBO,IACjC,OAAON,EAAAA,EAAAA,IAAYD,EAAI,C","sources":["webpack://admin/./src/views/systemManage/permissManage.vue","webpack://admin/./src/components/permissManage/addRolepopUp.vue","webpack://admin/src/components/permissManage/addRolepopUp.vue","webpack://admin/./src/components/permissManage/addRolepopUp.vue?b9e5","webpack://admin/./src/components/permissManage/addRolepopUp.vue?8a15","webpack://admin/./src/components/permissManage/permissionsTree.vue","webpack://admin/./src/utils/getTreeList.js","webpack://admin/src/components/permissManage/permissionsTree.vue","webpack://admin/./src/components/permissManage/permissionsTree.vue?6b52","webpack://admin/./src/components/permissManage/permissionsTree.vue?6f53","webpack://admin/src/views/systemManage/permissManage.vue","webpack://admin/./src/views/systemManage/permissManage.vue?e34f","webpack://admin/./src/views/systemManage/permissManage.vue?9c9d","webpack://admin/./src/services/systemManage.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"AllBox\"},[_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticClass:\"clearfix selectBox\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('el-button',{directives:[{name:\"has\",rawName:\"v-has\",value:(`system:role:add`),expression:\"`system:role:add`\"}],attrs:{\"type\":\"primary\",\"icon\":\"el-icon-delete\"},on:{\"click\":_vm.addRole}},[_vm._v(\"添加角色\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-delete\"},on:{\"click\":_vm.saveTreeBtn}},[_vm._v(\"保存角色\")])],1),_vm._l((_vm.rolesData),function(item){return _c('div',{key:item.roleId,staticClass:\"text item\"},[_c('div',{staticClass:\"itemInfo\"},[_vm._v(\" \"+_vm._s(item.name)+\" \")]),_c('div',{staticClass:\"itemBtn\"},[_c('el-button',{directives:[{name:\"has\",rawName:\"v-has\",value:(`system:role:getMenu`),expression:\"`system:role:getMenu`\"}],attrs:{\"type\":\"primary\",\"size\":\"mini\",\"icon\":\"el-icon-edit\",\"circle\":\"\"},on:{\"click\":function($event){return _vm.editRole(item)}}}),(item.roleId > 4)?_c('el-button',{directives:[{name:\"has\",rawName:\"v-has\",value:(`system:role:delete`),expression:\"`system:role:delete`\"}],attrs:{\"type\":\"primary\",\"size\":\"mini\",\"icon\":\"el-icon-delete\",\"circle\":\"\"},on:{\"click\":function($event){return _vm.deleteRole(item.roleId)}}}):_vm._e()],1)])})],2),_c('addRolepopUp',{ref:\"addRolepopUp\",on:{\"giveFather\":_vm.getSonData}}),_c('permissionsTree',{ref:\"PermissionsTree\"})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"AllBox\"},[_c('el-dialog',{attrs:{\"title\":\"添加角色\",\"visible\":_vm.dialogVisible,\"width\":\"30%\",\"center\":\"\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-form',{ref:\"dataForm\",staticClass:\"login_in\",attrs:{\"label-width\":\"0px\",\"model\":_vm.dataForm}},[_c('div',{staticClass:\"form-info\"},[_c('el-form-item',{attrs:{\"prop\":\"name\"}},[_c('el-input',{attrs:{\"type\":\"text\",\"prefix-icon\":\"el-icon-user\",\"placeholder\":\"请输入添加的角色名字\"},model:{value:(_vm.dataForm.name),callback:function ($$v) {_vm.$set(_vm.dataForm, \"name\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"dataForm.name\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"roleKey\"}},[_c('el-input',{attrs:{\"prefix-icon\":\"el-icon-user\",\"placeholder\":\"请输入添加角色的别名\"},model:{value:(_vm.dataForm.roleKey),callback:function ($$v) {_vm.$set(_vm.dataForm, \"roleKey\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"dataForm.roleKey\"}})],1)],1)]),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":_vm.closeDialogVisible}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.showDialogVisible(),_vm.giveFather()}}},[_vm._v(\"确 定\")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"AllBox\">\r\n    <el-dialog\r\n      title=\"添加角色\"\r\n      :visible.sync=\"dialogVisible\"\r\n      width=\"30%\" center>\r\n      \r\n      <el-form label-width=\"0px\" class=\"login_in\"  ref=\"dataForm\" :model=\"dataForm\">\r\n\r\n<div class=\"form-info\">\r\n  <el-form-item prop=\"name\">\r\n    <el-input\r\n      type=\"text\"\r\n      prefix-icon=\"el-icon-user\"\r\n      placeholder=\"请输入添加的角色名字\"\r\n      v-model.trim=\"dataForm.name\">\r\n    </el-input>\r\n  </el-form-item>\r\n  <el-form-item prop=\"roleKey\">\r\n    <el-input\r\n    prefix-icon=\"el-icon-user\"\r\n      placeholder=\"请输入添加角色的别名\"\r\n      v-model.trim=\"dataForm.roleKey\"\r\n    ></el-input>\r\n  </el-form-item>\r\n</div>\r\n\r\n</el-form>\r\n    <span slot=\"footer\" class=\"dialog-footer\">\r\n      <el-button @click=\"closeDialogVisible\">取 消</el-button>\r\n      <el-button type=\"primary\" @click=\"showDialogVisible(),giveFather()\">确 定</el-button>\r\n    </span>\r\n</el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    name:'addRolepopUp',\r\n    data() {\r\n      return {\r\n        dataForm:{\r\n          name:'',\r\n          roleKey:'',\r\n          roleId:6,\r\n        },\r\n        dialogVisible: false\r\n      };\r\n    },\r\n    methods:{\r\n      closeDialogVisible(){\r\n        this.dialogVisible = false\r\n      },\r\n      showDialogVisible(){\r\n         this.dialogVisible = !this.dialogVisible\r\n      },\r\n      giveFather(){\r\n        this.$emit('giveFather',this.dataForm)\r\n      }\r\n    }\r\n  };\r\n</script>\r\n<style>\r\n\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./addRolepopUp.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./addRolepopUp.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./addRolepopUp.vue?vue&type=template&id=7ae8d7eb&\"\nimport script from \"./addRolepopUp.vue?vue&type=script&lang=js&\"\nexport * from \"./addRolepopUp.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShowTree),expression:\"isShowTree\"}],staticClass:\"TreeBox\"},[_c('div',{staticClass:\"headerBox\"},[_c('el-tag',{staticClass:\"roleTitle\"},[_vm._v(\"编辑的角色是\")]),_c('el-tag',{staticClass:\"roleTitle\",attrs:{\"type\":\"danger\"}},[_vm._v(_vm._s(_vm.roleName))])],1),_c('el-tree',{ref:\"tree\",staticClass:\"TreeMain\",attrs:{\"data\":_vm.Tree,\"show-checkbox\":\"\",\"node-key\":\"menuId\",\"default-checked-keys\":_vm.roleTree}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//将权限树中勾选的相关数据处理\nexport const getCheckTreeList = (TreeList,Result) =>{\n    let list = []    //接收变量的数组\n    let item = {}    //中间变量的对象\n    let result = Result  //最终返回数据的数组\n    list = TreeList\n    list.forEach(element => {\n        item.menuId = element.menuId\n        result.push(item);\n        item={}\n    });\n    return result;\n} ","<template>\r\n  <div class=\"TreeBox\" v-show=\"isShowTree\">\r\n    <div class=\"headerBox\">\r\n      <el-tag class=\"roleTitle\">编辑的角色是</el-tag>\r\n      <el-tag type=\"danger\" class=\"roleTitle\">{{ roleName }}</el-tag>\r\n    </div>\r\n\r\n\r\n    <el-tree class=\"TreeMain\" :data=\"Tree\" show-checkbox node-key=\"menuId\" :default-checked-keys=\"roleTree\" ref=\"tree\">\r\n    </el-tree>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getCheckTreeList } from '@/utils/getTreeList'\r\nimport { lookRole, getTree, saveTree } from '@/services/systemManage'\r\nexport default {\r\n  name: 'permissionsTree',\r\n  data() {\r\n    return {\r\n      Tree: [],           //所有的权限构成的树形结构\r\n      roleTree: [],      //角色携带的相关权限\r\n      isShowTree: false, //权限树是否展示\r\n      modifyRight: [],   //修改后的权限保存\r\n      roleName: '',\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getTree()\r\n  },\r\n  methods: {\r\n    //获取一个角色已有的权限 \r\n    showTreeList(roleId, roleList, roleName) {\r\n      this.$refs.tree.setCheckedKeys([])\r\n      this.roleName = roleName\r\n      this.roleTree = []\r\n      lookRole(roleId).then((res) => {\r\n        console.log(res);\r\n        if (res.data.code === 200) {\r\n          let data = res.data.data\r\n          data.forEach(item => {\r\n            if (item.level === 4) {\r\n              roleList.push(item.menuId)\r\n            }\r\n          });\r\n          console.log('check', this.roleTree);\r\n          this.roleTree = roleList\r\n          this.isShowTree = true\r\n        }else if(res.data.code === 417){\r\n          this.roleTree = []\r\n          console.log(typeof this.roleTree);\r\n          this.isShowTree = true\r\n        }\r\n      })\r\n    },\r\n    //获取所有权限构成的树形结构 \r\n    getTree() {\r\n      getTree().then((res) => {\r\n        if (res.data.code === 200) {\r\n          this.Tree = res.data.data\r\n        }\r\n      })\r\n    },\r\n    //获取所有打了勾的权限 \r\n    getCheckedNodes() {\r\n      let data = getCheckTreeList(this.$refs.tree.getCheckedNodes(), this.modifyRight)\r\n      this.modifyRight = data\r\n    },\r\n    //获取半勾状态下的权限 \r\n    getHalfCheckedNodes() {\r\n      let data = getCheckTreeList(this.$refs.tree.getHalfCheckedNodes(), this.modifyRight)\r\n      this.modifyRight = data\r\n    },\r\n    //保存角色修改的权限 \r\n    saveRoleTreeBtn(roleId) {\r\n      if (this.isShowTree === false) {\r\n        this.$message.error(\"请查看角色权限后再保存\")\r\n      } else {\r\n        this.getCheckedNodes()\r\n        this.getHalfCheckedNodes()\r\n        let data = {}\r\n        data.roleId = roleId\r\n        data.menuList = this.modifyRight\r\n        saveTree(data).then((res) => {\r\n          if (res.data.code === 200) {\r\n            this.$message.success(\"修改角色权限成功！\")\r\n            this.isShowTree = false\r\n          } else {\r\n            this.$message.error(\"修改角色权限失败,请重新操作！\")\r\n          }\r\n          this.modifyRight = []\r\n        })\r\n      }\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.TreeBox {\r\n  width: 320px;\r\n\r\n  .headerBox {\r\n    width: 100%;\r\n\r\n    .backBtn {\r\n      margin: 10px 0 10px 10px;\r\n    }\r\n\r\n    .roleTitle {\r\n      margin-left: 10px;\r\n    }\r\n  }\r\n}\r\n\r\n.TreeMain {\r\n  ::v-deep .el-tree-node__content {\r\n    height: 32px;\r\n  }\r\n  ::v-deep .el-checkbox__inner{\r\n    width: 20px;\r\n    height: 20px;\r\n  }\r\n  ::v-deep .el-tree-node__label{\r\n    font-size: 16px;\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./permissionsTree.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./permissionsTree.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./permissionsTree.vue?vue&type=template&id=3422baee&scoped=true&\"\nimport script from \"./permissionsTree.vue?vue&type=script&lang=js&\"\nexport * from \"./permissionsTree.vue?vue&type=script&lang=js&\"\nimport style0 from \"./permissionsTree.vue?vue&type=style&index=0&id=3422baee&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3422baee\",\n  null\n  \n)\n\nexport default component.exports","<!--权限管理-->\r\n<template>\r\n  <div class=\"AllBox\">\r\n    <el-card class=\"box-card\">\r\n      <div slot=\"header\" class=\"clearfix selectBox\">\r\n        <el-button type=\"primary\" icon=\"el-icon-delete\" @click=\"addRole\" v-has=\"`system:role:add`\">添加角色</el-button>\r\n        <el-button type=\"primary\" icon=\"el-icon-delete\" @click=\"saveTreeBtn\">保存角色</el-button>\r\n      </div>\r\n      <div v-for=\"(item) in rolesData\" :key=\"item.roleId\" class=\"text item\">\r\n        <div class=\"itemInfo\">\r\n          {{ item.name }}\r\n        </div>\r\n        <div class=\"itemBtn\">\r\n          <el-button type=\"primary\" size=\"mini\" icon=\"el-icon-edit\" circle @click=\"editRole(item)\"\r\n            v-has=\"`system:role:getMenu`\"></el-button>\r\n          <el-button type=\"primary\" size=\"mini\" icon=\"el-icon-delete\" circle v-if=\"item.roleId > 4\"\r\n            @click=\"deleteRole(item.roleId)\" v-has=\"`system:role:delete`\"></el-button>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n    <addRolepopUp ref=\"addRolepopUp\" @giveFather=\"getSonData\"></addRolepopUp>\r\n    <permissionsTree ref=\"PermissionsTree\"></permissionsTree>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getRoleList, roleDelete, addRole } from '../../services/systemManage'\r\nimport addRolepopUp from '@/components/permissManage/addRolepopUp.vue'\r\nimport PermissionsTree from '@/components/permissManage/permissionsTree.vue';\r\nexport default {\r\n  data() {\r\n    return {\r\n      //存储角色的列表 \r\n      rolesData: [],\r\n      roleId: 0,\r\n      showTree: false,\r\n    };\r\n  },\r\n  components: {\r\n    addRolepopUp,\r\n    PermissionsTree,\r\n  },\r\n  mounted() {\r\n    //获取角色列表 \r\n    this.getRoles()\r\n  },\r\n  methods: {\r\n    //获取角色列表\r\n    getRoles() {\r\n      getRoleList().then((res) => {\r\n        console.log(res);\r\n        if (res.data.code === 200) {\r\n          this.rolesData = res.data.data;\r\n        } else if (res.data.code === 403) {\r\n          this.$message.error(\"权限不足！！！\")\r\n        }\r\n      })\r\n    },\r\n    //添加角色 \r\n    addRole() {\r\n      this.$refs.addRolepopUp.showDialogVisible()\r\n    },\r\n    //编辑角色 \r\n    editRole(item) {\r\n      this.showTree = true;\r\n      this.roleId = item.roleId\r\n      this.$refs.PermissionsTree.showTreeList(item.roleId, [], item.name)\r\n    },\r\n    //删除角色 \r\n    deleteRole(roleId) {\r\n      roleDelete(roleId).then((res) => {\r\n        if (res.data.code === 200) {\r\n          this.$message.success(\"删除角色成功！\")\r\n          this.getRoles()\r\n        } else {\r\n          this.$message.error(\"删除角色失败，请稍后重试！\")\r\n        }\r\n      })\r\n    },\r\n    //保存修改后的角色权限 \r\n    saveTreeBtn() {\r\n      this.$refs.PermissionsTree.saveRoleTreeBtn(this.roleId)\r\n    },\r\n    //获取子组件中的相关数据(用于添加用户) \r\n    getSonData(data) {\r\n      addRole(data).then((res) => {\r\n        if (res.data.code === 200) {\r\n          //自动刷新角色列表 \r\n          this.getRoles()\r\n        }\r\n      })\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.AllBox {\r\n  margin: 40px 10px;\r\n  display: flex;\r\n\r\n  .text {\r\n    font-size: 20px;\r\n  }\r\n\r\n  /deep/.item {\r\n    display: flex;\r\n    padding: 5px 0;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    height: 50px;\r\n    line-height: 30px;\r\n  }\r\n\r\n  .itemInfo {\r\n    margin-left: 10px;\r\n  }\r\n\r\n  .itemBtn {\r\n    margin-right: 15px;\r\n  }\r\n}\r\n\r\n.selectBox {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.clearfix:before,\r\n.clearfix:after {\r\n  display: table;\r\n  content: \"\";\r\n}\r\n\r\n.clearfix:after {\r\n  clear: both\r\n}\r\n\r\n.box-card {\r\n  width: 360px;\r\n\r\n  /deep/.el-card__body {\r\n    padding: 10px 30px;\r\n  }\r\n}\r\n\r\n.sendInfo {\r\n  width: 60px;\r\n  height: 50px;\r\n  margin: 15px 0;\r\n  background: red;\r\n  text-align: center;\r\n}\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./permissManage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./permissManage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./permissManage.vue?vue&type=template&id=598a71e4&scoped=true&\"\nimport script from \"./permissManage.vue?vue&type=script&lang=js&\"\nexport * from \"./permissManage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./permissManage.vue?vue&type=style&index=0&id=598a71e4&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"598a71e4\",\n  null\n  \n)\n\nexport default component.exports","import servers from './service'\r\n//获取角色列表 \r\nexport const getRoleList = () =>{\r\n  const url = '/admin/roles'\r\n  return servers.get(url)\r\n}\r\n//添加角色 \r\nexport const addRole = (data) =>{\r\n  const url = '/admin/roles'\r\n  return servers.post(url,data)\r\n}\r\n\r\n//查看一个角色的权限 \r\nexport const lookRole = (RoleId) =>{\r\n  const url = `/admin/roles/menu/${RoleId}`\r\n  return servers.get(url)\r\n}\r\n\r\n//获取所有权限树形结构\r\nexport const getTree = () =>{\r\n  const url = `/admin/menus/tree`\r\n  return servers.get(url)\r\n}\r\n\r\n//保存修改后的角色权限\r\nexport const saveTree = (data) =>{\r\n  const url = '/admin/roles/menu'\r\n  return servers.put(url,data,)\r\n}\r\n\r\n//删除一个角色\r\nexport const roleDelete = (roleId) =>{\r\n  const url = `/admin/roles/${roleId}`\r\n  return servers.delete(url)\r\n}\r\n//获取分页的相关数据\r\nexport const getuserListApi = (params) =>{\r\n  const url = `/admin/users/pages/${params}`\r\n  return servers.get(url)\r\n} \r\n//更新用户角色\r\nexport const renewRole = (data) =>{\r\n  const url = '/admin/users/role'\r\n  return servers.put(url,data)\r\n}\r\n//删除用户（根据id进行删除）\r\nexport const userDelete = (userId) =>{\r\n  const url = `/admin/users/${userId}`\r\n  return servers.delete(url)\r\n}\r\n//添加一个用户\r\nexport const addUser = (data) =>{\r\n  const url = `/admin/users`\r\n  return servers.post(url,data)\r\n}\r\n//获取日志列表\r\nexport const getLoglist = (params) =>{\r\n  const url = `/admin/logs/pages/${params}`\r\n  return servers.get(url)\r\n} \r\n\r\n\r\n//删除日子（根据id进行删除）\r\nexport const logDelete = (userId) =>{\r\n  const url = `/admin/logs/${userId}`\r\n  return servers.delete(url)\r\n}\r\n\r\n//批量删除\r\nexport const logsDelete = (data) =>{\r\n  const url = `/admin/logs`\r\n  return servers.post(url,data)\r\n}\r\n\r\n//查找指定用户校色（根据id进行删除）\r\nexport const userRole = (userId) =>{\r\n  const url = `/admin/users/role/${userId}`\r\n  return servers.get(url)\r\n}\r\n"],"names":["render","_vm","this","_c","_self","staticClass","attrs","slot","directives","name","rawName","value","expression","on","addRole","_v","saveTreeBtn","_l","rolesData","item","key","roleId","_s","$event","editRole","deleteRole","_e","ref","getSonData","staticRenderFns","dialogVisible","dataForm","model","callback","$$v","$set","trim","roleKey","closeDialogVisible","showDialogVisible","giveFather","data","methods","component","isShowTree","roleName","Tree","roleTree","getCheckTreeList","TreeList","Result","list","result","forEach","element","menuId","push","modifyRight","mounted","showTreeList","lookRole","console","roleList","getTree","getCheckedNodes","getHalfCheckedNodes","saveRoleTreeBtn","saveTree","showTree","components","addRolepopUp","PermissionsTree","getRoles","getRoleList","roleDelete","url","servers","RoleId","getuserListApi","params","renewRole","userDelete","userId","addUser","getLoglist","logDelete","logsDelete","userRole"],"sourceRoot":""}