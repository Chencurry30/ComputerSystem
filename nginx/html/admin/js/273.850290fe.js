"use strict";(self["webpackChunkadmin"]=self["webpackChunkadmin"]||[]).push([[273],{5449:function(e,t,s){s.d(t,{Z:function(){return u}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home"},[t("el-dialog",{attrs:{title:e.title,"append-to-body":"",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticStyle:{margin:"15px 0"}}),t("el-checkbox-group",{model:{value:e.userCheckList,callback:function(t){e.userCheckList=t},expression:"userCheckList"}},e._l(e.roleList,(function(s){return t("el-checkbox",{key:s.roleId,attrs:{label:s.roleId}},[e._v(e._s(s.name))])})),1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.closeDialogVisible()}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.subminRole()}}},[e._v("确 定")])],1)],1)],1)},i=[],r=(s(7658),s(8729)),l={name:"GiveRole",data(){return{form:{},dialogVisible:!1,activeName:"first",title:"选择角色",userCheckList:[],roleList:[]}},methods:{getAllRole(){(0,r.JV)().then((e=>{console.log(e),this.roleList=e.data.data}))},getUserRole(e){this.userCheckList=[],(0,r.xZ)(e.userId).then((e=>{let t=e.data.data;t.forEach((e=>{this.userCheckList[this.userCheckList.length++]=e.roleId})),this.userCheckList=Object.values(this.userCheckList)}))},showGiveRoles(e){this.userId=e.userId,this.getAllRole(),this.getUserRole(e),this.dialogVisible=!0},closeDialogVisible(){this.dialogVisible=!1},subminRole(){let e={};e.userId=this.userId,e.roleList=[],this.userCheckList.forEach((t=>{let s={roleId:t};e.roleList.push(s)})),(0,r.e1)(e).then((e=>{console.log(e),200===e.data.code&&(this.dialogVisible=!1,this.$parent.getFollowdiaryList())}))}}},o=l,n=s(1001),c=(0,n.Z)(o,a,i,!1,null,"b9fc6ec2",null),u=c.exports},3784:function(e,t,s){s.d(t,{Z:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"addRoleBox"},[t("el-dialog",{attrs:{title:"新增用户",visible:e.dialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"dataForm",staticClass:"login_in",attrs:{"label-width":"0px",model:e.dataForm,rules:e.checkForm}},[t("div",{staticClass:"form-info"},[t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{attrs:{type:"text","prefix-icon":"el-icon-user",placeholder:"请输入用户用户名"},model:{value:e.dataForm.username,callback:function(t){e.$set(e.dataForm,"username","string"===typeof t?t.trim():t)},expression:"dataForm.username"}})],1),t("el-form-item",{attrs:{prop:"email"}},[t("el-input",{attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入用户邮箱"},model:{value:e.dataForm.email,callback:function(t){e.$set(e.dataForm,"email","string"===typeof t?t.trim():t)},expression:"dataForm.email"}})],1),t("el-form-item",{attrs:{prop:"age"}},[t("el-input",{attrs:{type:"text","prefix-icon":"el-icon-user",placeholder:"请输入用户年龄"},model:{value:e.dataForm.age,callback:function(t){e.$set(e.dataForm,"age","string"===typeof t?t.trim():t)},expression:"dataForm.age"}})],1),t("el-form-item",{attrs:{prop:"sex"}},[t("el-select",{model:{value:e.dataForm.sex,callback:function(t){e.$set(e.dataForm,"sex",t)},expression:"dataForm.sex"}},[t("el-option",{attrs:{label:"女",value:"女"}}),t("el-option",{attrs:{label:"男",value:"男"}}),t("el-option",{attrs:{label:"保密",value:"保密"}})],1)],1)],1)]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeDialogVisible}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showDialogVisible,e.submit()}}},[e._v("确 定")])],1)],1)],1)},i=[],r=s(6310),l=s(8729),o={name:"addRolepopUp",data(){return{dataForm:{username:"",email:"",age:"",sex:"保密"},dialogVisible:!1,checkForm:{username:[{validator:r.y.Form().validateUserName,trigger:"blur"}],email:[{validator:r.y.Form().validateEmail,trigger:"blur"}],age:[{validator:r.y.Form().validataAge,trigger:"blur"}]}}},methods:{closeDialogVisible(){this.dialogVisible=!1},showDialogVisible(){this.dialogVisible=!this.dialogVisible},submit(){let e={};e.username=this.dataForm.username,e.email=this.dataForm.email,e.age=this.dataForm.age,e.sex=this.dataForm.sex,(0,l.cn)(e).then((e=>{200===e.data.code?(this.$message({message:"添加用户成功！",type:"success"}),this.dialogVisible=!1,this.$parent.getFollowdiaryList()):411===e.data.code?this.$message({message:"用户名重复！",type:"error"}):406===e.data.code&&this.$message({message:e.data.message,type:"error"})}))}}},n=o,c=s(1001),u=(0,c.Z)(n,a,i,!1,null,null,null),d=u.exports},7273:function(e,t,s){s.r(t),s.d(t,{default:function(){return m}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home"},[t("div",{staticClass:"nav-select"},[t("div",{staticClass:"nav-left"},[t("el-button",{directives:[{name:"has",rawName:"v-has",value:"system:user:add",expression:"`system:user:add`"}],attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addSubBtn}},[e._v(" 新 增 ")])],1)]),t("div",{staticClass:"tableBox",staticStyle:{width:"100%"}},[e._m(0),e._l(e.tableData,(function(s){return t("div",{key:s.userId,staticClass:"tableDataItem"},[t("div",{staticClass:"userId"},[e._v(e._s(s.userId))]),t("div",{staticClass:"username"},[e._v(e._s(s.username))]),t("div",{staticClass:"nickname"},[e._v(e._s(s.nickname))]),t("div",{staticClass:"email"},[e._v(e._s(s.email))]),t("div",{staticClass:"sex"},[e._v(e._s(s.sex))]),t("div",{staticClass:"age"},[e._v(e._s(s.age))]),t("div",{staticClass:"roles"},e._l(s.roles,(function(s){return t("el-tag",{key:s.roleId,attrs:{type:"success"}},[e._v(e._s(s.name))])})),1),t("div",{staticClass:"action"},[t("el-button",{directives:[{name:"has",rawName:"v-has",value:"system:user:update",expression:"`system:user:update`"}],attrs:{type:"success",size:"mini"},on:{click:function(t){return e.giveUserRole(s)}}},[e._v("赋角色")]),t("el-button",{directives:[{name:"has",rawName:"v-has",value:"system:user:delete",expression:"`system:user:delete`"}],attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteROW(s)}}},[e._v("删除")])],1)])}))],2),t("el-pagination",{staticClass:"page",attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize},on:{"current-change":e.handleCurrentChange}}),t("GiveRole",{ref:"GiveRole"}),t("addUserpopUp",{ref:"addUserpopUp"})],1)},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"tableTypeNav"},[t("div",{staticClass:"userId"},[e._v("ID")]),t("div",{staticClass:"username"},[e._v("用户名")]),t("div",{staticClass:"nickname"},[e._v("昵称")]),t("div",{staticClass:"email"},[e._v("邮箱")]),t("div",{staticClass:"sex"},[e._v("性别")]),t("div",{staticClass:"age"},[e._v("年龄")]),t("div",{staticClass:"roles"},[e._v("角色")]),t("div",{staticClass:"action"},[e._v("操作")])])}],r=s(5449),l=s(3784),o=s(8729),n={name:"MemberArchive",data(){return{searchForm:{key:""},tableData:[],total:0,page:1,pageSize:6}},components:{GiveRole:r.Z,addUserpopUp:l.Z},mounted(){this.getFollowdiaryList()},methods:{getFollowdiaryList(){(0,o.Xu)(this.page).then((e=>{200===e.data.code?(this.tableData=e.data.data.list,this.total=e.data.data.total):417===e.data.code&&(this.tableData=[],this.total=0)}))},handleCurrentChange(e){this.page=e,this.getFollowdiaryList()},giveUserRole(e){this.$refs.GiveRole.showGiveRoles(e)},deleteROW(e){this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,o.DZ)(e.userId).then((()=>{this.$message({message:"删除用户成功！",type:"success"}),this.getFollowdiaryList()})).catch((()=>{console.log("错误捕获")}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},addSubBtn(){this.$refs.addUserpopUp.showDialogVisible()}}},c=n,u=s(1001),d=(0,u.Z)(c,a,i,!1,null,"f3246dce",null),m=d.exports},8729:function(e,t,s){s.d(t,{DZ:function(){return m},EJ:function(){return p},Fe:function(){return c},IM:function(){return o},JV:function(){return i},W1:function(){return g},Xu:function(){return u},Y2:function(){return n},_d:function(){return r},cn:function(){return h},e1:function(){return d},pR:function(){return l},q0:function(){return v},xZ:function(){return f}});var a=s(4498);const i=()=>{const e="/admin/roles";return a.Z.get(e)},r=e=>{const t="/admin/roles";return a.Z.post(t,e)},l=e=>{const t=`/admin/roles/menu/${e}`;return a.Z.get(t)},o=()=>{const e="/admin/menus/tree";return a.Z.get(e)},n=e=>{const t="/admin/roles/menu";return a.Z.put(t,e)},c=e=>{const t=`/admin/roles/${e}`;return a.Z["delete"](t)},u=e=>{const t=`/admin/users/pages/${e}`;return a.Z.get(t)},d=e=>{const t="/admin/users/role";return a.Z.put(t,e)},m=e=>{const t=`/admin/users/${e}`;return a.Z["delete"](t)},h=e=>{const t="/admin/users";return a.Z.post(t,e)},p=e=>{const t=`/admin/logs/pages/${e}`;return a.Z.get(t)},g=e=>{const t=`/admin/logs/${e}`;return a.Z["delete"](t)},v=e=>{const t="/admin/logs";return a.Z.post(t,e)},f=e=>{const t=`/admin/users/role/${e}`;return a.Z.get(t)}}}]);
//# sourceMappingURL=273.850290fe.js.map