"use strict";(self["webpackChunkweb_7"]=self["webpackChunkweb_7"]||[]).push([[182],{8840:function(t,e,a){a.r(e),a.d(e,{default:function(){return b}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"MainBox w"},[e("div",{staticClass:"containBox"},[e("personAside"),e("div",{staticClass:"contain-right"},[e("div",{staticClass:"showBox"},[e("div",{staticClass:"allBox"},[e("personHeader"),e("div",{staticClass:"allBox"},[e("div",{staticClass:"UserBox second"},[e("div",[e("div",{staticClass:"form-group"},[e("label",{staticClass:"contents"},[t._v("发表我的动态")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.contents.content,expression:"contents.content"}],staticClass:"form-control",attrs:{placeholder:"说说你的心情......"},domProps:{value:t.contents.content},on:{input:function(e){e.target.composing||t.$set(t.contents,"content",e.target.value)}}}),e("el-button",{attrs:{type:"text",size:"large"},on:{click:function(e){t.showDialog=!t.showDialog}}},[t._v("😃")]),e("VEmojiPicker",{directives:[{name:"show",rawName:"v-show",value:t.showDialog,expression:"showDialog"}],on:{select:t.selectEmoji}}),e("uploadDypicture")],1),e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-primary",on:{click:t.AddDynamics}},[t._v("发表动态")])]),t._l(t.Dynamics,(function(s){return e("div",{key:s.dynamicId,staticClass:"dynamicsItem"},[e("div",{staticClass:"dynamicsItemMain"},[e("div",{staticClass:"dynamicsItemHeader"},[e("div",{staticClass:"dynamiscItemUserImage"},["无"===s.author.image?e("img",{attrs:{src:a(1927),alt:""}}):e("img",{attrs:{src:[t.getpicture+s.author.image],alt:""}})]),e("div",{staticClass:"dynamiscItemUserInformation"},[e("div",{staticClass:"nickName"},[t._v(t._s(s.author.nickname))]),e("div",{staticClass:"createDate"},[t._v(t._s(s.createDate))])])]),e("div",{staticClass:"dynamicsItemMiddle"},[e("div",{staticClass:"middleContent"},[t._v(t._s(s.content))])]),e("div",{staticClass:"dynamicsItemBottom"},[s.picture?e("img",{attrs:{src:[t.getpicture+s.picture],alt:""}}):t._e()])])])})),e("div",{staticClass:"dynamicsPaging"},[e("el-pagination",{staticClass:"page",attrs:{background:"",layout:"prev, pager, next",total:t.totals,"page-size":t.pageSize},on:{"current-change":t.handleCurrentChange,"prev-click":t.prevPage,"next-click":t.nextPage}})],1)],2)])])],1)])])],1)])},i=[],o=a(3822),n=a(3683),c=a(2325),l=function(){var t=this,e=t._self._c;return e("div",[e("el-upload",{staticClass:"upload-demo",attrs:{action:t.objectData.host,"before-upload":t.getPolicy,"on-preview":t.handlePreview,"on-remove":t.handleRemove,"on-success":t.handleAvatarSuccess,"file-list":t.fileList,data:t.objectData,"show-file-list":!0}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("上传照片")]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")]),t.objectData.key?e("img",{attrs:{src:t.imageUrl}}):t._e()],1)],1)},r=[],d=a(2273),m={data(){return{objectData:{OSSAccessKeyId:"",policy:"",Signature:"",key:"",host:"",dir:""},fileList:[],imageUrl:""}},methods:{getPolicy(t){return console.log(t),new Promise(((e,a)=>{(0,d.Ov)(t.name).then((t=>{console.log(t),this.objectData.OSSAccessKeyId=t.data.data.accessid,this.objectData.policy=t.data.data.policy,this.objectData.Signature=t.data.data.signature,this.objectData.dir=t.data.data.dir,this.objectData.host=t.data.data.host,this.objectData.key=t.data.data.key,this.$parent.contents.picture=t.data.data.key,console.log(this.$parent.contents.picture),e(!0)})).catch((t=>{console.log(t),a(!1)}))}))},handleRemove(t,e){console.log(t,e)},handlePreview(t){console.log(t)},handleAvatarSuccess(t,e){this.imageUrl=URL.createObjectURL(e.raw)}}},g=m,h=a(3736),u=(0,h.Z)(g,l,r,!1,null,"65b31cf7",null),p=u.exports,v=a(8231),y=a(262),C={data(){return{showDialog:!1,Dynamics:[],page:1,pageSize:5,totals:0,contents:{content:"",picture:""},fileList:[{name:"",url:""}]}},components:{personAside:v.Z,personHeader:y.Z,uploadDypicture:p,VEmojiPicker:n.WE},name:"teacherReply",mounted(){this.$store.dispatch("userInfo/getUserInfo"),this.GetDynamics()},methods:{selectEmoji(t){console.log(typeof t.data),this.contents.content=this.contents.content+t.data},backHome(){let t={name:"Home"};this.$router.push(t)},AddDynamics(){(0,d.Kt)(this.contents).then((t=>{console.log(this.contents),406===t.data.code?this.$message.error("内容不能为空"):200===t.data.code&&this.$message.success("发布动态成功！"),this.contents={},this.GetDynamics()}))},GetDynamics(){(0,d.Vx)(this.page).then((t=>{console.log(t),this.totals=t.data.data.total,console.log(this.totals),this.Dynamics=t.data.data.list,console.log(this.Dynamics)}))},handleCurrentChange(t){this.page=t,this.GetDynamics()},prevPage(t){this.page=t-1},nextPage(t){this.page=t+1}},computed:{afterChangeData(){let t=(this.pageNo-1)*this.pageSize,e=this.pageNo*this.pageSize;return this.Dynamics.slice(t,e)},...(0,o.Se)("userInfo",{getUserImg:"getUserImg"}),...(0,o.Se)("userInfo",{getUserInfo:"getUserInfo"}),getpicture(){return(0,c.Yt)()}}},f=C,D=(0,h.Z)(f,s,i,!1,null,"0bd509ec",null),b=D.exports}}]);
//# sourceMappingURL=182.35f15422.js.map