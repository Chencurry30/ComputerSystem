"use strict";(self["webpackChunkweb_7"]=self["webpackChunkweb_7"]||[]).push([[642],{4207:function(s,t,e){e.r(t),e.d(t,{default:function(){return U}});var a=function(){var s=this,t=s._self._c;return t("div",{staticClass:"MainBox w"},[t("div",{staticClass:"containBox"},[t("personAside"),t("div",{staticClass:"contain-right"},[t("div",{staticClass:"showBox"},[t("div",{staticClass:"allBox"},[t("personHeader"),t("div",{staticClass:"userAction"},[t("div",{staticClass:"friendBox"},[s._m(0),t("div",{staticClass:"friendBoxMain",on:{mouseleave:s.mouseLeaveFriend}},s._l(s.userFridenList,(function(a){return t("div",{key:a.userId,staticClass:"friendItem centerLocation redPort",class:{maskFriednBox:s.userCurrent===a.userId},on:{mouseenter:function(t){return s.mouseEnterFriend(a)},click:function(t){return s.showPopupBox(a.userId,a.image,a.nickname)}}},[t("div",{staticClass:"ItemLeft"},["无"===a.image?t("div",{staticClass:"userImg"},[t("img",{attrs:{src:e(1927),alt:""}})]):t("div",{staticClass:"userImg"},[t("img",{attrs:{src:[s.publicUrl+a.image],alt:""}})]),t("div",{staticClass:"userName"},[s._v(s._s(a.nickname))])]),t("span",{staticClass:"Port",class:{hiddenRedPord:0===a.isRedSpot}})])})),0),t("ChatPopup",{ref:"ChatPopup"})],1),t("div",{staticClass:"searchFriendBox"},[s._m(1),t("div",{staticClass:"friendBoxSearch"},[t("div",{staticClass:"search"},[t("div",{staticClass:"searchImg",on:{click:s.searchFriend}},[t("img",{attrs:{src:e(2432),alt:""}})]),t("div",{staticClass:"searchBox"},[t("div",{staticClass:"searchMain"},[t("input",{directives:[{name:"model",rawName:"v-model",value:s.firendNickName,expression:"firendNickName"}],staticClass:"inputType",attrs:{type:"text",placeholder:"请输入搜索内容"},domProps:{value:s.firendNickName},on:{input:function(t){t.target.composing||(s.firendNickName=t.target.value)}}})])])])]),t("div",{staticClass:"friendBoxSearchList"},s._l(s.searchFridenList,(function(a){return t("div",{key:a.userId,staticClass:"friendItem centerLocation"},[t("div",{staticClass:"ItemLeft"},["无"===a.image?t("div",{staticClass:"userImg"},[t("img",{attrs:{src:e(1927),alt:""}})]):t("div",{staticClass:"userImg"},[t("img",{attrs:{src:[s.publicUrl+a.image],alt:""}})]),t("div",{staticClass:"userName"},[s._v(s._s(a.nickname))])]),t("div",{staticClass:"ItemRight",on:{click:function(t){return s.addFriend(a.userId,a.isFriend)}}},[s._v(" 添加好友 ")])])})),0),t("addUserFriend",{ref:"addUserFriend"})],1)])],1)])])],1)])},i=[function(){var s=this,t=s._self._c;return t("div",{staticClass:"friendBoxHeader"},[t("span",{staticClass:"headerP1"},[s._v("我的研友")]),t("span",{staticClass:"headerP2"},[s._v("My Friend")]),t("span",{staticClass:"headerP3"},[s._v("SETTINGS")])])},function(){var s=this,t=s._self._c;return t("div",{staticClass:"friendBoxHeader"},[t("span",{staticClass:"headerP1"},[s._v("我的研友")]),t("span",{staticClass:"headerP2"},[s._v("My Friend")]),t("span",{staticClass:"headerP3"},[s._v("SETTINGS")])])}],r=e(9931),n=e(262),o=function(){var s=this,t=s._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:s.showDialog,expression:"showDialog"}],staticClass:"tab-content"},[t("div",{staticClass:"contentBox"},[t("div",{staticClass:"chatHeader"},[t("div",{staticClass:"chatToUserTitle"},[s._v(s._s(s.friendNickName))]),t("div",{staticClass:"closeImg",on:{click:s.closePopup}},[t("img",{attrs:{src:e(9286),alt:""}})])]),t("div",{ref:"chatRoom",staticClass:"chatMain"},[t("div",{ref:"content"},s._l(s.msgList,(function(e,a){return t("div",{key:a,staticClass:"chatItem",class:{reverseChatItem:e.from===s.userId}},[t("div",{staticClass:"userImg"},[t("img",{attrs:{src:[s.publicUrl+s.titleImg(e.from)],alt:""}})]),t("div",{staticClass:"usercommunication",class:{reverseCommunication:e.from===s.userId}},[s._v(" "+s._s(e.message)+" ")])])})),0)]),t("div",{staticClass:"chatBottom"},[t("el-input",{staticClass:"chatInformationBox",attrs:{type:"textarea",autosize:{minRows:2,maxRows:3},autofocus:!0},model:{value:s.chatUserCommunication,callback:function(t){s.chatUserCommunication=t},expression:"chatUserCommunication"}})],1),t("div",{staticClass:"chatSendBtn"},[t("el-button",{attrs:{type:"success"},on:{click:function(t){return s.sendInfo()}}},[s._v("发送")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return s.giveFatherAction()}}},[s._v("关闭")])],1)])])},c=[],d=e(2273),l=e(2325),u={name:"passwordPopup",data(){return{rowsData:{minRows:2,maxRows:6},showDialog:!1,chatUserCommunication:"",msgList:[],userId:0,userImg:sessionStorage.getItem("userImg"),friendId:0,friendImage:"",friendNickName:""}},mounted(){this.scrollToBottom()},methods:{showPopup(s,t,e){let a=sessionStorage.getItem("userId");this.socket=new WebSocket(`ws://localhost:8989/api/websocket/${a}-${s}`),this.socket.onmessage=s=>{this.msgList.push(JSON.parse(s.data))},this.userId=parseInt(a),this.friendId=parseInt(s),this.friendImage=t,this.friendNickName=e,this.userFriendContact(a,s),this.showDialog=!0,this.scrollToBottom()},closePopup(){this.socket.close(),this.socket=null,this.showDialog=!1},giveFatherAction(){this.$parent.closePopupBox()},userFriendContact(s,t){(0,d.C3)(s,t).then((s=>{this.msgList=s.data}))},sendInfo(){if(""===this.chatUserCommunication)this.$message.error("发送的内容不能为空");else{let s={from:this.userId,to:this.friendId,message:this.chatUserCommunication,time:new Date};this.chatUserCommunication="",this.socket.send(JSON.stringify(s)),this.msgList.push(s),this.scrollToBottom()}},scrollToBottom(){setTimeout((()=>{let s=this.$refs["chatRoom"];s.scrollTop=s.scrollHeight}),30)}},computed:{publicUrl(){return(0,l.Yt)()},titleImg(){return function(s){return s===this.userId?this.userImg:this.friendImage}}}},h=u,m=e(3736),v=(0,m.Z)(h,o,c,!1,null,"58b243b9",null),p=v.exports,C=function(){var s=this,t=s._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:s.showDialog,expression:"showDialog"}],staticClass:"tab-content"},[t("div",{staticClass:"contentBox"},[t("div",{staticClass:"DialogHeader"},[t("div",{staticClass:"Dialogtitle"},[s._v("添加好友")]),t("div",{staticClass:"closeImg",on:{click:s.closePopup}},[t("img",{attrs:{src:e(9286),alt:""}})])]),t("div",{staticClass:"content-body"},[t("div",{staticClass:"content-main"},[t("div",{staticClass:"body-item"},[t("div",{staticClass:"laber"},[s._v("验证消息")]),t("input",{directives:[{name:"model",rawName:"v-model",value:s.validationData,expression:"validationData"}],staticClass:"laber-info",attrs:{type:"text"},domProps:{value:s.validationData},on:{input:function(t){t.target.composing||(s.validationData=t.target.value)}}}),t("i",{staticClass:"laber-line"})]),t("div",{staticClass:"sendInfo btn",on:{click:s.sendAddUserFriendData}},[s._v("发送验证")])])])])])},g=[],f={name:"addUserFriend",data(){return{showDialog:!1,validationData:"",friendId:0}},methods:{showPopup(s){this.friendId=s,this.showDialog=!0},closePopup(){this.showDialog=!1,this.validationData=""},sendAddUserFriendData(){if(""===this.validationData)this.$message.error("请输入相关的验证信息,更方便的通过对方添加");else{let s={};s.friendId=this.friendId,s.reason=this.validationData,(0,d.LI)(s).then((s=>{200===s.data.code?(this.$message.success("申请成功"),this.showDialog=!1):400===s.data.code&&this.$message.error(s.data.message)}))}}}},I=f,w=(0,m.Z)(I,C,g,!1,null,"06eef6ca",null),A=w.exports,x={data(){return{userFridenList:[],userCurrent:0,searchFridenList:[],firendNickName:"",interval:""}},components:{personAside:r.Z,personHeader:n.Z,ChatPopup:p,addUserFriend:A},name:"teacherReply",mounted(){this.$store.dispatch("userInfo/getUserInfo"),this.getUserFriend(),this.interval=setInterval((()=>{this.getUserFriend()}),2500)},beforeDestroy(){clearInterval(this.interval)},methods:{getUserFriend(){(0,d.rj)().then((s=>{200===s.data.code&&(this.userFridenList=s.data.data)}))},showPopupBox(s,t,e){clearInterval(this.interval),this.interval=null,this.$refs.ChatPopup.showPopup(s,t,e)},closePopupBox(){this.getUserFriend(),this.$refs.ChatPopup.closePopup(),this.interval=setInterval((()=>{this.getUserFriend()}),2500)},searchFriend(){let s=this.firendNickName;console.log(s.length),0===s.length?this.$message.error("搜索昵称不能为空"):(0,d.fg)(s).then((s=>{406===s.data.code?this.$message.error(s.data.message):this.searchFridenList=s.data.data}))},addFriend(s,t){1===t?this.$message.success("该用户已经是好友了,禁止再次添加"):this.$refs.addUserFriend.showPopup(s)},mouseEnterFriend(s){this.userCurrent=s.userId},mouseLeaveFriend(){this.userCurrent=0}},computed:{publicUrl(){return(0,l.Yt)()}},watch:{$route:{handler(s){"userChat"===s.name&&clearInterval(this.interval)},immediate:!0}}},F=x,k=(0,m.Z)(F,a,i,!1,null,"80830672",null),U=k.exports},9286:function(s){s.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABIklEQVRYR+2WSw6CMBCGGVi7BxpOoQfwAHom4U7u9QKegtBwAHcEMDUQm1ramQJpNLCex8ffeUHg+QPP+YMNYFPAqADnfN+27S7LsrtLsdZ1fWqa5mnynwQoy/IYRdFNJO77vmCM5RSIqqpyALgMPoc0TR86fxQAFUJJHoRheI7j+EoCEMZqIIwSVB9rF1ACUmxHNawAOiUAIE+SpJAldUku/FEANgjX5CSAKYiu60CqdnLHoBUY5Vb/Vn4GTJGqnUAG0ClBbVMZ4vcAvD6BrtrflfwZuesVoanVVm9DTALVRjesyLvANoDUgC4Qxi5wCYhRC9WG8j0wFNrX/J+6DxZZxzIA9j0Ny4l+kIhgXk8yyvk1x9ZpFM9JuMgy2gD+SoEXnEfyIXSYIEEAAAAASUVORK5CYII="}}]);
//# sourceMappingURL=642.d41d46ea.js.map