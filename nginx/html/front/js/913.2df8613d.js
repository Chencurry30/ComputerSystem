"use strict";(self["webpackChunkweb_7"]=self["webpackChunkweb_7"]||[]).push([[913],{6064:function(s,e,t){t.r(e),t.d(e,{default:function(){return U}});var a=function(){var s=this,e=s._self._c;return e("div",{staticClass:"MainBox w"},[e("div",{staticClass:"containBox"},[e("personAside"),e("div",{staticClass:"contain-right"},[e("div",{staticClass:"showBox"},[e("div",{staticClass:"allBox"},[e("personHeader"),e("div",{staticClass:"userAction"},[e("div",{staticClass:"friendBox"},[s._m(0),e("div",{staticClass:"friendBoxMain",on:{mouseleave:s.mouseLeaveFriend}},s._l(s.userFridenList,(function(a){return e("div",{key:a.userId,staticClass:"friendItem centerLocation redPort",class:{maskFriednBox:s.userCurrent===a.userId},on:{mouseenter:function(e){return s.mouseEnterFriend(a)},click:function(e){return s.showPopupBox(a.userId,a.image,a.nickname)}}},[e("div",{staticClass:"ItemLeft"},["无"===a.image?e("div",{staticClass:"userImg"},[e("img",{attrs:{src:t(1927),alt:""}})]):e("div",{staticClass:"userImg"},[e("img",{attrs:{src:[s.publicUrl+a.image],alt:""}})]),e("div",{staticClass:"userName"},[s._v(s._s(a.nickname))])]),e("span",{staticClass:"Port",class:{hiddenRedPord:0===a.isRedSpot}})])})),0),e("ChatPopup",{ref:"ChatPopup"})],1),e("div",{staticClass:"searchFriendBox"},[s._m(1),e("div",{staticClass:"friendBoxSearch"},[e("div",{staticClass:"search"},[e("div",{staticClass:"searchImg",on:{click:s.searchFriend}},[e("img",{attrs:{src:t(2432),alt:""}})]),e("div",{staticClass:"searchBox"},[e("div",{staticClass:"searchMain"},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.firendNickName,expression:"firendNickName"}],staticClass:"inputType",attrs:{type:"text",placeholder:"请输入搜索内容"},domProps:{value:s.firendNickName},on:{input:function(e){e.target.composing||(s.firendNickName=e.target.value)}}})])])])]),e("div",{staticClass:"friendBoxSearchList"},s._l(s.searchFridenList,(function(a){return e("div",{key:a.userId,staticClass:"friendItem centerLocation"},[e("div",{staticClass:"ItemLeft"},["无"===a.image?e("div",{staticClass:"userImg"},[e("img",{attrs:{src:t(1927),alt:""}})]):e("div",{staticClass:"userImg"},[e("img",{attrs:{src:[s.publicUrl+a.image],alt:""}})]),e("div",{staticClass:"userName"},[s._v(s._s(a.nickname))])]),e("div",{staticClass:"ItemRight",on:{click:function(e){return s.addFriend(a.userId,a.isFriend)}}},[s._v(" 添加好友 ")])])})),0),e("addUserFriend",{ref:"addUserFriend"})],1)])],1)])])],1)])},i=[function(){var s=this,e=s._self._c;return e("div",{staticClass:"friendBoxHeader"},[e("span",{staticClass:"headerP1"},[s._v("我的好友")]),e("span",{staticClass:"headerP2"},[s._v("My Friend")]),e("span",{staticClass:"headerP3"},[s._v("SETTINGS")])])},function(){var s=this,e=s._self._c;return e("div",{staticClass:"friendBoxHeader"},[e("span",{staticClass:"headerP1"},[s._v("我的研友")]),e("span",{staticClass:"headerP2"},[s._v("My Friend")]),e("span",{staticClass:"headerP3"},[s._v("SETTINGS")])])}],r=t(8231),n=t(262),o=function(){var s=this,e=s._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:s.showDialog,expression:"showDialog"}],staticClass:"tab-content"},[e("div",{staticClass:"contentBox"},[e("div",{staticClass:"chatHeader"},[e("div",{staticClass:"chatToUserTitle"},[s._v(s._s(s.friendNickName))]),e("div",{staticClass:"closeImg",on:{click:s.closePopup}},[e("img",{attrs:{src:t(9286),alt:""}})])]),e("div",{ref:"chatMain",staticClass:"chatMain"},s._l(s.msgList,(function(t,a){return e("div",{key:a,staticClass:"chatItem",class:{reverseChatItem:t.from===s.userId}},[e("div",{staticClass:"userImg"},[e("img",{attrs:{src:[s.publicUrl+s.titleImg(t.from)],alt:""}})]),e("div",{staticClass:"usercommunication",class:{reverseCommunication:t.from===s.userId}},[s._v(" "+s._s(t.message)+" ")])])})),0),e("div",{staticClass:"chatBottom"},[e("el-input",{staticClass:"chatInformationBox",attrs:{type:"textarea",autosize:{minRows:2,maxRows:3},autofocus:!0},model:{value:s.chatUserCommunication,callback:function(e){s.chatUserCommunication=e},expression:"chatUserCommunication"}})],1),e("div",{staticClass:"chatSendBtn"},[e("el-button",{attrs:{type:"success"},on:{click:function(e){return s.sendInfo()}}},[s._v("发送")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return s.giveFatherAction()}}},[s._v("关闭")])],1)])])},c=[],d=t(2273),l=t(2325),u={name:"passwordPopup",data(){return{rowsData:{minRows:2,maxRows:6},showDialog:!1,chatUserCommunication:"",msgList:[],userId:0,userImg:sessionStorage.getItem("userImg"),friendId:0,friendImage:"",friendNickName:""}},methods:{showPopup(s,e,t){let a=sessionStorage.getItem("userId");this.socket=new WebSocket(`ws://localhost:8989/api/websocket/${a}-${s}`),this.socket.onmessage=s=>{this.msgList.push(JSON.parse(s.data))},this.userId=parseInt(a),this.friendId=parseInt(s),this.friendImage=e,this.friendNickName=t,this.userFriendContact(a,s),this.showDialog=!0},closePopup(){this.socket.close(),this.socket=null,this.showDialog=!1},giveFatherAction(){this.$parent.closePopupBox()},userFriendContact(s,e){(0,d.C3)(s,e).then((s=>{this.msgList=s.data}))},sendInfo(){if(""===this.chatUserCommunication)this.$message.error("发送的内容不能为空");else{let s={from:this.userId,to:this.friendId,message:this.chatUserCommunication,time:new Date};this.chatUserCommunication="",this.socket.send(JSON.stringify(s)),this.msgList.push(s)}}},computed:{publicUrl(){return(0,l.Yt)()},titleImg(){return function(s){return s===this.userId?this.userImg:this.friendImage}}}},h=u,m=t(3736),v=(0,m.Z)(h,o,c,!1,null,"43e035e4",null),p=v.exports,g=function(){var s=this,e=s._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:s.showDialog,expression:"showDialog"}],staticClass:"tab-content"},[e("div",{staticClass:"contentBox"},[e("div",{staticClass:"header"},[e("div",{staticClass:"headerPopup"},[s._v("添加好友")]),e("div",{staticClass:"closeImg",on:{click:s.closePopup}},[e("img",{attrs:{src:t(9286),alt:""}})])]),e("div",{staticClass:"content-body"},[e("div",{staticClass:"content-main"},[e("div",{staticClass:"body-item"},[e("div",{staticClass:"laber"},[s._v("验证消息")]),e("input",{directives:[{name:"model",rawName:"v-model",value:s.validationData,expression:"validationData"}],staticClass:"laber-info",attrs:{type:"text"},domProps:{value:s.validationData},on:{input:function(e){e.target.composing||(s.validationData=e.target.value)}}}),e("i",{staticClass:"laber-line"})]),e("div",{staticClass:"sendInfo btn",on:{click:s.sendAddUserFriendData}},[s._v("发送验证")])])])])])},C=[],f={name:"addUserFriend",data(){return{showDialog:!1,validationData:"",friendId:0}},methods:{showPopup(s){this.friendId=s,this.showDialog=!0},closePopup(){this.showDialog=!1},sendAddUserFriendData(){if(""===this.validationData)this.$message.error("请输入相关的验证信息,更方便的通过对方添加");else{let s={};s.friendId=this.friendId,s.reason=this.validationData,(0,d.LI)(s).then((s=>{console.log(s),200===s.data.code?this.showDialog=!1:400===s.data.code&&this.$message.error(s.data.message)}))}}}},I=f,w=(0,m.Z)(I,g,C,!1,null,"6407888e",null),A=w.exports,x={data(){return{userFridenList:[],userCurrent:0,searchFridenList:[],firendNickName:"",interval:""}},components:{personAside:r.Z,personHeader:n.Z,ChatPopup:p,addUserFriend:A},name:"teacherReply",mounted(){this.$store.dispatch("userInfo/getUserInfo"),this.getUserFriend(),this.interval=setInterval((()=>{this.getUserFriend()}),2500)},beforeDestroy(){clearInterval(this.interval),console.log("页面被销毁")},methods:{getUserFriend(){(0,d.rj)().then((s=>{this.userFridenList=s.data.data,console.log(s)}))},showPopupBox(s,e,t){clearInterval(this.interval),this.interval=null,this.$refs.ChatPopup.showPopup(s,e,t)},closePopupBox(){console.log("我执行了关闭弹窗的函数"),this.getUserFriend(),this.$refs.ChatPopup.closePopup(),this.interval=setInterval((()=>{this.getUserFriend()}),2500)},searchFriend(){let s=this.firendNickName;console.log(s.length),0===s.length?this.$message.error("搜索昵称不能为空"):(0,d.fg)(s).then((s=>{406===s.data.code?this.$message.error(s.data.message):(console.log(s),this.searchFridenList=s.data.data)}))},addFriend(s,e){1===e?this.$message.success("该用户已经是好友了,禁止再次添加"):this.$refs.addUserFriend.showPopup(s)},mouseEnterFriend(s){this.userCurrent=s.userId},mouseLeaveFriend(){this.userCurrent=0}},computed:{publicUrl(){return(0,l.Yt)()}},watch:{$route:{handler(s){console.log(s),"userChat"===s.name&&clearInterval(this.interval)},immediate:!0}}},F=x,k=(0,m.Z)(F,a,i,!1,null,"0264bfb8",null),U=k.exports},9286:function(s){s.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABIklEQVRYR+2WSw6CMBCGGVi7BxpOoQfwAHom4U7u9QKegtBwAHcEMDUQm1ramQJpNLCex8ffeUHg+QPP+YMNYFPAqADnfN+27S7LsrtLsdZ1fWqa5mnynwQoy/IYRdFNJO77vmCM5RSIqqpyALgMPoc0TR86fxQAFUJJHoRheI7j+EoCEMZqIIwSVB9rF1ACUmxHNawAOiUAIE+SpJAldUku/FEANgjX5CSAKYiu60CqdnLHoBUY5Vb/Vn4GTJGqnUAG0ClBbVMZ4vcAvD6BrtrflfwZuesVoanVVm9DTALVRjesyLvANoDUgC4Qxi5wCYhRC9WG8j0wFNrX/J+6DxZZxzIA9j0Ny4l+kIhgXk8yyvk1x9ZpFM9JuMgy2gD+SoEXnEfyIXSYIEEAAAAASUVORK5CYII="}}]);
//# sourceMappingURL=913.2df8613d.js.map