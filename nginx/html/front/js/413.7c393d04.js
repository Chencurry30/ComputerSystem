(self["webpackChunkweb_7"]=self["webpackChunkweb_7"]||[]).push([[413],{1187:function(o,s,t){"use strict";t.d(s,{Z:function(){return d}});var e=function(){var o=this,s=o._self._c;return s("div",{staticClass:"getVerificationCode",on:{click:o.getVerCode}},[o._v(" "+o._s(o.verificationCodeInfo)+" ")])},i=[],a=t(2694),n={props:["phone"],name:"sendCodeBtn",data(){return{sendTimeCode:30,bVerification:!1,verificationCodeInfo:"发送验证码"}},methods:{getVerCode(){if(""===this.phone)return;if(!0===this.bVerification)return;this.bVerification=!0;let o=setInterval((()=>{this.sendTimeCode-=1,this.verificationCodeInfo=`${this.sendTimeCode}秒后发送`,this.sendTimeCode<=0&&(this.verificationCodeInfo="发送验证码",this.sendTimeCode=30,clearInterval(o),this.bVerification=!1)}),1e3),s={phone:this.phone};(0,a.TG)(s).then((o=>{console.log(o.data.code),414===o.data.code?this.$message.error("手机号为空，请输入手机号"):413===o.data.code?this.$message.error("手机号已注册，请输入新的手机号"):200===o.data.code&&this.$message({message:"验证码已发送，请注意查收",type:"success"})}))}}},r=n,l=t(3736),p=(0,l.Z)(r,e,i,!1,null,"51e63a14",null),d=p.exports},7991:function(o,s,t){"use strict";t.r(s),t.d(s,{default:function(){return V}});var e=function(){var o=this,s=o._self._c;return s("div",{staticClass:"MainBox w MainPageHeader"},[s("div",{staticClass:"containBox"},[s("personAside"),s("div",{staticClass:"contain-right"},[s("personHeader"),o.judgePhone?s("div",{staticClass:"UserBox"},[s("div",{staticClass:"boxbody"},[o._m(0),s("div",{staticClass:"muted-color"},[o._v("修改绑定的手机号，避免手机号不能使用")]),s("div",{staticClass:"btn",on:{click:function(s){return o.changePhone(1)}}},[o._v("修改手机号")]),s("phonePopup",{ref:"phonePopup"})],1)]):s("div",{staticClass:"UserBox"},[s("div",{staticClass:"boxbody"},[o._m(1),s("div",{staticClass:"muted-color"},[o._v("绑定手机号,增加账号的安全性")]),s("div",{staticClass:"btn",on:{click:o.bindUserPhone}},[o._v("绑定手机号")]),s("bindPhone",{ref:"bindPhone"})],1)]),s("div",{staticClass:"UserBox"},[s("div",{staticClass:"boxbody"},[o._m(2),s("div",{staticClass:"muted-color"},[o._v("定期修改账号密码，提高账号的安全性")]),s("div",{staticClass:"btn",on:{click:o.changePassword}},[o._v("修改密码")]),s("passwordPopup",{ref:"passwordPopup"})],1)])],1)],1)])},i=[function(){var o=this,s=o._self._c;return s("div",{staticClass:"title-h"},[s("span",[o._v("修改绑定手机号")])])},function(){var o=this,s=o._self._c;return s("div",{staticClass:"title-h"},[s("span",[o._v("绑定手机号")])])},function(){var o=this,s=o._self._c;return s("div",{staticClass:"title-h"},[s("span",[o._v("修改密码")])])}],a=t(9931),n=t(262),r=function(){var o=this,s=o._self._c;return s("div",{directives:[{name:"show",rawName:"v-show",value:o.dialogVisible,expression:"dialogVisible"}],ref:"phonePopup",staticClass:"userDialog"},[s("div",{staticClass:"DialogBox"},[s("div",{staticClass:"DialogHeader"},[s("div",{staticClass:"Dialogtitle"},[o._v("修改手机号")]),s("div",{staticClass:"closeImg",on:{click:o.closePopup}},[s("img",{attrs:{src:t(9286),alt:""}})])]),s("div",{staticClass:"DialogBody"},[s("div",{staticClass:"contentHeader"},[s("el-steps",{attrs:{active:o.active,"finish-status":"success","align-center":!0}},[s("el-step",{attrs:{title:"步骤 1"}}),s("el-step",{attrs:{title:"步骤 2"}}),s("el-step",{attrs:{title:"步骤 3"}})],1)],1),s("div",{staticClass:"contentMain"},[s("el-form",{ref:"showPopupInfo",staticClass:"userInfoBox",attrs:{"label-width":"80px",model:o.showPopupInfo,rules:o.checkForm}},[1===o.active?s("div",{staticClass:"formBox"},[s("el-form-item",{attrs:{label:"手机号",prop:"oldPhone"}},[s("el-input",{staticClass:"nick-info",attrs:{type:"text",placeholder:"请输入绑定的手机号"},model:{value:o.showPopupInfo.oldPhone,callback:function(s){o.$set(o.showPopupInfo,"oldPhone","string"===typeof s?s.trim():s)},expression:"showPopupInfo.oldPhone"}})],1),s("el-form-item",{staticClass:"smsCode",attrs:{label:"验证码",prop:"oldSmsCode"}},[s("el-input",{attrs:{type:"text",placeholder:"验证码"},model:{value:o.showPopupInfo.oldSmsCode,callback:function(s){o.$set(o.showPopupInfo,"oldSmsCode","string"===typeof s?s.trim():s)},expression:"showPopupInfo.oldSmsCode"}}),s("sendCodeBtn",{attrs:{phone:o.showPopupInfo.oldPhone}})],1)],1):2===o.active?s("div",{staticClass:"formBox"},[s("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[s("el-input",{staticClass:"nick-info",attrs:{type:"text",placeholder:"请输入新的手机号"},model:{value:o.showPopupInfo.phone,callback:function(s){o.$set(o.showPopupInfo,"phone","string"===typeof s?s.trim():s)},expression:"showPopupInfo.phone"}})],1),s("el-form-item",{staticClass:"smsCode",attrs:{label:"验证码",prop:"smsCode"}},[s("el-input",{attrs:{type:"text",placeholder:"验证码"},model:{value:o.showPopupInfo.smsCode,callback:function(s){o.$set(o.showPopupInfo,"smsCode","string"===typeof s?s.trim():s)},expression:"showPopupInfo.smsCode"}}),s("sendCodeBtn",{attrs:{phone:o.showPopupInfo.phone}})],1)],1):s("div",{staticClass:"formBox"},[s("div",{staticClass:"formBoxItem"},[s("div",{staticClass:"BoxItemTitle"},[o._v("解绑的手机号:")]),s("div",{staticClass:"BoxItemData"},[o._v(o._s(o.showPopupInfo.oldPhone))])]),s("div",{staticClass:"formBoxItem"},[s("div",{staticClass:"BoxItemTitle"},[o._v("绑定的手机号:")]),s("div",{staticClass:"BoxItemData"},[o._v(o._s(o.showPopupInfo.phone))])]),s("div",{staticClass:"formBoxItem"},[s("div",{staticClass:"BoxItemTitle"},[o._v("解绑的手机号的验证码:")]),s("div",{staticClass:"BoxItemData"},[o._v(o._s(o.showPopupInfo.oldSmsCode))])]),s("div",{staticClass:"formBoxItem"},[s("div",{staticClass:"BoxItemTitle"},[o._v("绑定的手机号的验证码:")]),s("div",{staticClass:"BoxItemData"},[o._v(o._s(o.showPopupInfo.smsCode))])])])])],1),1===o.active||2===o.active?s("div",{staticClass:"contentBottom"},[s("el-button",{staticStyle:{margin:"6px 10px"},on:{click:function(s){return o.preActionBtn()}}},[o._v("上一步")]),s("el-button",{staticStyle:{margin:"6px 10px"},on:{click:function(s){return o.nextActionBtn()}}},[o._v("下一步")])],1):s("div",{staticClass:"contentBottom"},[s("el-button",{staticStyle:{margin:"6px 10px"},on:{click:function(s){return o.preActionBtn()}}},[o._v("上一步")]),s("el-button",{staticStyle:{margin:"6px 10px"},on:{click:function(s){return o.sendActionData()}}},[o._v("提交")])],1)])])])},l=[],p=t(1187),d=t(6310),c=t(2694),h={name:"PopupWindow",data(){return{dialogVisible:!1,active:1,showPopupInfo:{oldPhone:"",oldSmsCode:"",phone:"",smsCode:""},checkForm:{oldPhone:[{validator:d.y.Form().validatePhone,trigger:"blur"}],phone:[{validator:d.y.Form().validatePhone,trigger:"blur"}]}}},components:{sendCodeBtn:p.Z},methods:{showPopup(o){this.active=o,this.dialogVisible=!0},closePopup(){this.dialogVisible=!1},preActionBtn(){this.active<2?this.active=1:(this.closePopup(),this.$parent.changePhone(this.active-1))},nextActionBtn(){this.active>2?this.active=3:(this.closePopup(),this.$parent.changePhone(this.active+1))},sendActionData(){""===this.showPopupInfo.oldPhone||""===this.showPopupInfo.oldSmsCode||""===this.showPopupInfo.phone||""===this.showPopupInfo.smsCode?this.$message.error("请填写完完整数据后再提交"):(0,c.Ks)(this.showPopupInfo).then((o=>{407===o.data.code?this.$message.error("解绑的手机号验证码错误"):200===o.data.code&&this.$message.success(o.data.message),console.log(o)}))}}},u=h,f=t(3736),m=(0,f.Z)(u,r,l,!1,null,"0d284a48",null),v=m.exports,w=function(){var o=this,s=o._self._c;return s("div",{directives:[{name:"show",rawName:"v-show",value:o.showDialog,expression:"showDialog"}],staticClass:"userDialog"},[s("div",{staticClass:"DialogBox"},[s("div",{staticClass:"DialogHeader"},[s("div",{staticClass:"Dialogtitle"},[o._v("修改密码")]),s("div",{staticClass:"closeImg",on:{click:o.closePopup}},[s("img",{attrs:{src:t(9286),alt:""}})])]),s("div",{staticClass:"DialogBody"},[s("div",{staticClass:"content-main"},[s("el-form",{ref:"showPopupInfo",staticClass:"userInfoBox",attrs:{"label-width":"80px",model:o.showPopupInfo,rules:o.checkForm}},[s("div",{staticClass:"formBox"},[s("div",{staticClass:"formLeft"},[s("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[s("el-input",{staticClass:"nick-info",attrs:{type:"text",placeholder:"请输入手机号"},model:{value:o.showPopupInfo.phone,callback:function(s){o.$set(o.showPopupInfo,"phone","string"===typeof s?s.trim():s)},expression:"showPopupInfo.phone"}})],1),s("el-form-item",{attrs:{label:"旧密码",prop:"oldPassword"}},[s("el-input",{staticClass:"nick-info",attrs:{type:"text",placeholder:"请输入旧密码"},model:{value:o.showPopupInfo.oldPassword,callback:function(s){o.$set(o.showPopupInfo,"oldPassword","string"===typeof s?s.trim():s)},expression:"showPopupInfo.oldPassword"}})],1),s("el-form-item",{attrs:{label:"新密码",prop:"password"}},[s("el-input",{staticClass:"nick-info",attrs:{type:"text",placeholder:"请输入新密码"},model:{value:o.showPopupInfo.password,callback:function(s){o.$set(o.showPopupInfo,"password","string"===typeof s?s.trim():s)},expression:"showPopupInfo.password"}})],1),s("el-form-item",{staticClass:"smsCode",attrs:{label:"验证码",prop:"smsCode"}},[s("el-input",{attrs:{type:"text",placeholder:"验证码"},model:{value:o.showPopupInfo.smsCode,callback:function(s){o.$set(o.showPopupInfo,"smsCode","string"===typeof s?s.trim():s)},expression:"showPopupInfo.smsCode"}}),s("sendCodeBtn",{attrs:{phone:o.showPopupInfo.phone}})],1)],1)])]),s("div",{staticClass:"saveBtn",on:{click:function(s){return o.modifyPassWordAction()}}},[o._v("提交")])],1)])])])},P=[],C=t(3822),g=t(2325),I={name:"passwordPopup",components:{sendCodeBtn:p.Z},data(){return{showDialog:!1,showPopupInfo:{oldPassword:"",password:"",phone:"",smsCode:""},checkForm:{password:[{validator:d.y.Form().validatePassWord,trigger:"blur"}],oldPassword:[{validator:d.y.Form().validatePassWord,trigger:"blur"}],phone:[{validator:d.y.Form().validatePhone,trigger:"blur"}]}}},methods:{showPopup(){this.showDialog=!0},closePopup(){this.showDialog=!1},getPublicKey(){this.$store.dispatch("encryption/getPubKey")},modifyPassWordAction(){this.getPublicKey(),setTimeout((()=>{let o={};o.oldPassword=(0,g.ry)(this.getkeyInfo.encryPtion,this.showPopupInfo.oldPassword),o.password=(0,g.ry)(this.getkeyInfo.encryPtion,this.showPopupInfo.password),o.phone=this.showPopupInfo.phone,o.smsCode=this.showPopupInfo.smsCode,o.uuId=this.getkeyInfo.uuId,""===this.showPopupInfo.phone?this.$message.error("手机号不能为空"):""===this.showPopupInfo.oldPassword?this.$message.error("旧密码不能为空"):""===this.showPopupInfo.password?this.$message.error("新密码不能为空"):""===this.showPopupInfo.smsCode?this.$message.error("验证码不能为空"):(0,c.Io)(o).then((o=>{200===o.data.code?(this.$message.success("修改密码成功"),this.showDialog=!0):406===o.data.code?this.$message.error("原密码错误"):407===o.data.code&&this.$message.error("手机验证码错误"),console.log(o)}))}),1500)}},computed:{...(0,C.Se)("encryption",{getkeyInfo:"getkeyInfo"})}},x=I,b=(0,f.Z)(x,w,P,!1,null,"74bf982a",null),y=b.exports,A=function(){var o=this,s=o._self._c;return s("div",{directives:[{name:"show",rawName:"v-show",value:o.showDialog,expression:"showDialog"}],staticClass:"userDialog"},[s("div",{staticClass:"DialogBox"},[s("div",{staticClass:"DialogHeader"},[s("div",{staticClass:"Dialogtitle"},[o._v("绑定手机号")]),s("div",{staticClass:"closeImg",on:{click:o.closePopup}},[s("img",{attrs:{src:t(9286),alt:""}})])]),s("div",{staticClass:"DialogBody"},[s("div",{staticClass:"content-main"},[s("el-form",{ref:"showPopupInfo",staticClass:"userInfoBox",attrs:{"label-width":"80px",model:o.showPopupInfo,rules:o.checkForm}},[s("div",{staticClass:"formBox"},[s("div",{staticClass:"formLeft"},[s("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[s("el-input",{staticClass:"nick-info",attrs:{type:"text",placeholder:"请输入手机号"},model:{value:o.showPopupInfo.phone,callback:function(s){o.$set(o.showPopupInfo,"phone","string"===typeof s?s.trim():s)},expression:"showPopupInfo.phone"}})],1),s("el-form-item",{staticClass:"smsCode",attrs:{label:"验证码",prop:"smsCode"}},[s("el-input",{attrs:{type:"text",placeholder:"验证码"},model:{value:o.showPopupInfo.smsCode,callback:function(s){o.$set(o.showPopupInfo,"smsCode","string"===typeof s?s.trim():s)},expression:"showPopupInfo.smsCode"}}),s("sendCodeBtn",{attrs:{phone:o.showPopupInfo.phone}})],1)],1)])]),s("div",{staticClass:"saveBtn",on:{click:function(s){return o.modifyPhoneAction()}}},[o._v("绑定手机号")])],1)])])])},B=[],_={name:"bindPhone",components:{sendCodeBtn:p.Z},data(){return{showDialog:!1,showPopupInfo:{phone:"",smsCode:""},checkForm:{phone:[{validator:d.y.Form().validatePhone,trigger:"blur"}]}}},methods:{showPopup(){this.showDialog=!0,console.log("我是绑定手机号的弹窗")},closePopup(){this.showDialog=!1},getPublicKey(){this.$store.dispatch("encryption/getPubKey")},modifyPhoneAction(){""===this.showPopupInfo.phone?(this.$message.error("请输入绑定的手机号"),this.showPopupInfo={}):(0,c.nq)(this.showPopupInfo).then((o=>{200===o.data.code?(this.$message.success("绑定成功"),this.showDialog=!1):407===o.data.code&&this.$message.error("手机验证码错误")}))}}},k=_,$=(0,f.Z)(k,A,B,!1,null,"145118ae",null),D=$.exports,E={components:{phonePopup:v,bindPhone:D,passwordPopup:y,personAside:a.Z,personHeader:n.Z},name:"personSecurity",mounted(){this.$store.dispatch("userInfo/getUserInfo")},methods:{changePhone(o){this.$refs.phonePopup.showPopup(o)},changePassword(){this.$refs.passwordPopup.showPopup()},bindUserPhone(){this.$refs.bindPhone.showPopup()}},computed:{judgePhone(){return void 0===sessionStorage.getItem("userPhone")}}},Z=E,S=(0,f.Z)(Z,e,i,!1,null,"3bfb61ea",null),V=S.exports},6310:function(o,s){let t=/^[a-zA-Z0-9]{2,12}$/,e=/^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/,i=/^(?=.*[a-zA-Z])(?=.*\d).{6,12}$/,a=/^120$|^[1-9]$|^(1[0-1]|[1-9])\d$/,n=/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/,r=/^[\u4e00-\u9fa5a-zA-Z0-9]{2,12}$/,l=/^[\u4e00-\u9fa5]{1,20}$/,p=function(){function o(){}return o.Form=function(){return{validateUserName(o,s,e){if(""===s)return e(new Error("请输入账号"));t.test(s)?e():e(new Error("账号必须为2-12位(必须包含数字与字母)"))},validatePhone(o,s,t){if(""===s)return t(new Error("请输入手机号码"));e.test(s)?t():t(new Error("手机格式不正确"))},validatePassWord(o,s,t){if(""===s)return t(new Error("请输入密码"));i.test(s)?t():t(new Error("密码为6-12位(必须包含数字和字母)"))},validataAge(o,s,t){""!==s?a.test(s)?t():t(new Error("年龄的范围为1-120")):t("请输入年龄")},validateEmail(o,s,t){""!==s?n.test(s)?t():(console.log(123),t(new Error("邮箱格式不正确"))):t(new Error("请输入邮箱"))},validateNickName(o,s,t){""!==s?r.test(s)?t():t(new Error("格式不对(2-12位(数字,字母,中文))")):t(new Error("请输入昵称"))},validatePersonalMessage(o,s,t){""!==s?l.test(s)?t():t(new Error("留言格式不对(2~20)只能是中文")):t(new Error("请输入个人留言"))}}},o}();s.y=p},9286:function(o){"use strict";o.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABIklEQVRYR+2WSw6CMBCGGVi7BxpOoQfwAHom4U7u9QKegtBwAHcEMDUQm1ramQJpNLCex8ffeUHg+QPP+YMNYFPAqADnfN+27S7LsrtLsdZ1fWqa5mnynwQoy/IYRdFNJO77vmCM5RSIqqpyALgMPoc0TR86fxQAFUJJHoRheI7j+EoCEMZqIIwSVB9rF1ACUmxHNawAOiUAIE+SpJAldUku/FEANgjX5CSAKYiu60CqdnLHoBUY5Vb/Vn4GTJGqnUAG0ClBbVMZ4vcAvD6BrtrflfwZuesVoanVVm9DTALVRjesyLvANoDUgC4Qxi5wCYhRC9WG8j0wFNrX/J+6DxZZxzIA9j0Ny4l+kIhgXk8yyvk1x9ZpFM9JuMgy2gD+SoEXnEfyIXSYIEEAAAAASUVORK5CYII="}}]);
//# sourceMappingURL=413.7c393d04.js.map