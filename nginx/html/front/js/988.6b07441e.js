(self["webpackChunkweb_7"]=self["webpackChunkweb_7"]||[]).push([[988],{3988:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return w}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"SystemUserBox"},[t("div",{staticClass:"loginBox"},[t("div",{staticClass:"loginFormTitle"},[e._v("用户登录")]),t("el-form",{ref:"dataForm",staticClass:"loginForm",attrs:{"label-width":"0px",model:e.dataForm,rules:e.checkForm}},[t("div",{staticClass:"formData"},[t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{attrs:{type:"text","prefix-icon":"el-icon-user",placeholder:"请输入账号"},model:{value:e.dataForm.username,callback:function(t){e.$set(e.dataForm,"username","string"===typeof t?t.trim():t)},expression:"dataForm.username"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{type:!0===e.changeHiddenImg?"text":"password","prefix-icon":"el-icon-thumb",placeholder:"请输入密码"},on:{focus:e.showImg},model:{value:e.dataForm.password,callback:function(t){e.$set(e.dataForm,"password","string"===typeof t?t.trim():t)},expression:"dataForm.password"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showHiddenImg,expression:"showHiddenImg"}],staticClass:"clickImg",on:{click:e.changeImg}},[t("div",{class:!0===e.changeHiddenImg?"showImg":"hiddenImg"})])],1)],1),t("div",{staticClass:"loginSelectNav"},[t("div",{staticClass:"navleft"},[t("div",{staticClass:"leftbtn"},[t("div",{class:!1===e.automaticLogin?"dashDiv":"dashDivSelectd"},[t("span",{staticClass:"dashSpan",on:{click:e.submitLogin}})]),t("div",{staticClass:"prompt"},[e._v("自动登录")])])]),t("div",{staticClass:"navright"},[t("div",{staticClass:"prompt",on:{click:e.gotoretrieve}},[e._v("忘记密码")])])]),t("el-form-item",{staticClass:"reterieveBtn"},[t("el-button",{attrs:{type:"primary",disabled:!e.canSubmit},on:{click:function(t){return e.goToLogin("dataForm")}}},[e._v("登    录 ")])],1),t("div",{staticClass:"userBack"},[t("div",{staticClass:"userBack-left font-text"},[t("router-link",{attrs:{to:{name:"Home"}}},[e._v("返回首页")])],1),t("div",{staticClass:"userBack-right font-text"},[t("router-link",{attrs:{to:{name:"registerView"}}},[e._v("用户注册")])],1)])],1)],1)])},s=[];
/*! js-cookie v3.0.1 | MIT */
function o(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)e[r]=a[r]}return e}var i={read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function n(e,t){function a(a,r,s){if("undefined"!==typeof document){s=o({},t,s),"number"===typeof s.expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),a=encodeURIComponent(a).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var n in s)s[n]&&(i+="; "+n,!0!==s[n]&&(i+="="+s[n].split(";")[0]));return document.cookie=a+"="+e.write(r,a)+i}}function r(t){if("undefined"!==typeof document&&(!arguments.length||t)){for(var a=document.cookie?document.cookie.split("; "):[],r={},s=0;s<a.length;s++){var o=a[s].split("="),i=o.slice(1).join("=");try{var n=decodeURIComponent(o[0]);if(r[n]=e.read(i,n),t===n)break}catch(d){}}return t?r[t]:r}}return Object.create({set:a,get:r,remove:function(e,t){a(e,"",o({},t,{expires:-1}))},withAttributes:function(e){return n(this.converter,o({},this.attributes,e))},withConverter:function(e){return n(o({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var d=n(i,{path:"/"}),c=d,m=a(2694),u=a(2325),l=a(3822),g=a(6310),h={name:"loginView",inject:["reload"],data(){return{automaticLogin:!1,showHiddenImg:!1,changeHiddenImg:!1,dataForm:{username:"",password:""},checkForm:{username:[{validator:g.y.Form().validateUserName,trigger:"blur"}],password:[{validator:g.y.Form().validatePassWord,trigger:"blur"}]}}},mounted(){this.reload()},methods:{getPublicKey(){this.$store.dispatch("encryption/getPubKey")},submitLogin(){this.automaticLogin=!this.automaticLogin},backHome(){let e={name:"mainHome"};this.$router.push(e)},gotoretrieve(){let e={name:"retrievePassword"};this.$router.push(e)},showImg(){this.showHiddenImg=!0},changeImg(){this.changeHiddenImg=!this.changeHiddenImg},goToLogin(e){this.getPublicKey(),setTimeout((()=>{this.$refs[e].validate((e=>{if(e)if(""===this.getkeyInfo.encryPtion)this.$message.error("密码加密失败，请重新点击登录按钮");else{let e={};e.uuId=this.getkeyInfo.uuId,e.username=this.dataForm.username,e.password=(0,u.ry)(this.getkeyInfo.encryPtion,this.dataForm.password),(0,m.n$)(e).then((e=>{if(console.log(e),200===e.data.code){c.set("name",e.data.data.user.nickname);const t=e.data.data.token,a=e.data.data.user.image,r=e.data.data.user.userId,s=e.data.data.user.nickname||"无",o=e.data.data.user.phone||"无",i=e.data.data.teacherId||0;sessionStorage.setItem("userImg",a),sessionStorage.setItem("userId",r),sessionStorage.setItem("token",t),sessionStorage.setItem("nickname",s),sessionStorage.setItem("userPhone",o),sessionStorage.setItem("teacherId",i),this.$message({message:"恭喜你，登录成功！欢迎用户: "+s,type:"success"}),this.$router.push({name:"Home"}),this.reload()}else(409===e.data.code||500===e.data.code)&&this.$message.error(e.data.message)}))}else this.$message.error("请按照提示要求修改后再进行登录")}))}),1e3)}},computed:{canSubmit(){const{username:e,password:t}=this.dataForm;return Boolean(e&&t)},...(0,l.Se)("encryption",{getkeyInfo:"getkeyInfo"})}},p=h,f=a(3736),v=(0,f.Z)(p,r,s,!1,null,"1c6dfd1a",null),w=v.exports},6310:function(e,t){let a=/^[a-zA-Z0-9]{2,12}$/,r=/^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/,s=/^(?=.*[a-zA-Z])(?=.*\d).{6,12}$/,o=/^120$|^[1-9]$|^(1[0-1]|[1-9])\d$/,i=/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/,n=/^[\u4e00-\u9fa5a-zA-Z0-9]{2,12}$/,d=/^[\u4e00-\u9fa5]{1,20}$/,c=function(){function e(){}return e.Form=function(){return{validateUserName(e,t,r){if(""===t)return r(new Error("请输入账号"));a.test(t)?r():r(new Error("账号必须为2-12位(必须包含数字与字母)"))},validatePhone(e,t,a){if(""===t)return a(new Error("请输入手机号码"));r.test(t)?a():a(new Error("手机格式不正确"))},validatePassWord(e,t,a){if(""===t)return a(new Error("请输入密码"));s.test(t)?a():a(new Error("密码为6-12位(必须包含数字和字母)"))},validataAge(e,t,a){""!==t?o.test(t)?a():a(new Error("年龄的范围为1-120")):a("请输入年龄")},validateEmail(e,t,a){""!==t?i.test(t)?a():(console.log(123),a(new Error("邮箱格式不正确"))):a(new Error("请输入邮箱"))},validateNickName(e,t,a){""!==t?n.test(t)?a():a(new Error("格式不对(2-12位(数字,字母,中文))")):a(new Error("请输入昵称"))},validatePersonalMessage(e,t,a){""!==t?d.test(t)?a():a(new Error("留言格式不对(2~20)只能是中文")):a(new Error("请输入个人留言"))}}},e}();t.y=c}}]);
//# sourceMappingURL=988.6b07441e.js.map